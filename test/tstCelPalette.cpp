//---------------------------------------------------------------------------//
//!
//! \file   tstCelPalette.cpp
//! \author Alex Robinson
//! \brief  The cel palette unit tests
//!
//---------------------------------------------------------------------------//

// Std Lib Includes
#include <iostream>
#include <memory>

// Qt Includes
#include <QtTest/QtTest>
#include <QFile>

// QtD1 Includes
#include "MPQProperties.h"
#include "MPQHandler.h"
#include "CelPalette.h"

//---------------------------------------------------------------------------//
// Test suite.
//---------------------------------------------------------------------------//
class TestCelPalette : public QObject
{
  Q_OBJECT

private slots:

  void initTestCase()
  {
    // Register the MPQHandler with the file engine system
    QtD1::MPQHandler::getInstance();
  }

//---------------------------------------------------------------------------//
// Tests.
//---------------------------------------------------------------------------//
// Check that the name of the cel palette can be returned
void getName()
{
  // Basic constructor
  std::unique_ptr<QtD1::CelPalette>
    palette( new QtD1::CelPalette( "/levels/towndata/town.pal" ) );

  QCOMPARE( palette->getName(), QString("/levels/towndata/town.pal") );

  // Advanced constructor
  QFile palette_file( "/levels/towndata/town.pal" );
  palette_file.open( QIODevice::ReadOnly );
  
  QByteArray palette_data( palette_file.size(), 0 );
  palette_file.read( palette_data.data(), palette_data.size() );
  
  palette.reset( new QtD1::CelPalette( "/levels/towndata/town.pal", palette_data ) );

  QCOMPARE( palette->getName(), QString("/levels/towndata/town.pal") );
}

//---------------------------------------------------------------------------//
// Check that the transparent color key can be returned
void getTransparentColorKey()
{
  // Basic constructor
  std::unique_ptr<QtD1::CelPalette>
    palette( new QtD1::CelPalette("/levels/towndata/town.pal") );

  QCOMPARE( palette->getTransparentColorKey(), 255 );

  // Advanced constructor
  QFile palette_file( "/levels/towndata/town.pal" );
  palette_file.open( QIODevice::ReadOnly );
  
  QByteArray palette_data( palette_file.size(), 0 );
  palette_file.read( palette_data.data(), palette_data.size() );
  
  palette.reset( new QtD1::CelPalette( "/levels/towndata/town.pal", palette_data ) );

  QCOMPARE( palette->getTransparentColorKey(), 255 );
}

//---------------------------------------------------------------------------//
// Check that the color corresponding to a color key can be returned
void getColor()
{
  std::unique_ptr<QtD1::CelPalette>
    palette( new QtD1::CelPalette("/levels/towndata/town.pal") );

  QCOMPARE( palette->getColor( 0 ), QColor(0, 0, 0, 255) );
  QCOMPARE( palette->getColor( 1 ), QColor(181, 93, 27, 255) );
  QCOMPARE( palette->getColor( 2 ), QColor(165, 93, 54, 255) );
  QCOMPARE( palette->getColor( 3 ), QColor(165, 85, 24, 255) );
  QCOMPARE( palette->getColor( 4 ), QColor(152, 86, 49, 255) );
  QCOMPARE( palette->getColor( 5 ), QColor(143, 86, 59, 255) );
  QCOMPARE( palette->getColor( 6 ), QColor(156, 84, 29, 255) );
  QCOMPARE( palette->getColor( 7 ), QColor(141, 88, 27, 255) );
  QCOMPARE( palette->getColor( 8 ), QColor(145, 82, 41, 255) );
  QCOMPARE( palette->getColor( 9 ), QColor(139, 82, 49, 255) );
  QCOMPARE( palette->getColor( 10 ), QColor(132, 73, 44, 255) );
  QCOMPARE( palette->getColor( 11 ), QColor(161, 62, 18, 255) );
  QCOMPARE( palette->getColor( 12 ), QColor(145, 66, 39, 255) );
  QCOMPARE( palette->getColor( 13 ), QColor(82, 83, 117, 255) );
  QCOMPARE( palette->getColor( 14 ), QColor(136, 70, 17, 255) );
  QCOMPARE( palette->getColor( 15 ), QColor(120, 69, 51, 255) );
  QCOMPARE( palette->getColor( 16 ), QColor(116, 74, 24, 255) );
  QCOMPARE( palette->getColor( 17 ), QColor(120, 66, 41, 255) );
  QCOMPARE( palette->getColor( 18 ), QColor(204, 24, 33, 255) );
  QCOMPARE( palette->getColor( 19 ), QColor(107, 74, 24, 255) );
  QCOMPARE( palette->getColor( 20 ), QColor(78, 74, 99, 255) );
  QCOMPARE( palette->getColor( 21 ), QColor(120, 64, 26, 255) );
  QCOMPARE( palette->getColor( 22 ), QColor(73, 71, 110, 255) );
  QCOMPARE( palette->getColor( 23 ), QColor(206, 16, 32, 255) );
  QCOMPARE( palette->getColor( 24 ), QColor(107, 66, 24, 255) );
  QCOMPARE( palette->getColor( 25 ), QColor(198, 16, 33, 255) );
  QCOMPARE( palette->getColor( 26 ), QColor(78, 66, 92, 255) );
  QCOMPARE( palette->getColor( 27 ), QColor(198, 16, 24, 255) );
  QCOMPARE( palette->getColor( 28 ), QColor(99, 66, 24, 255) );
  QCOMPARE( palette->getColor( 29 ), QColor(101, 61, 44, 255) );
  QCOMPARE( palette->getColor( 30 ), QColor(83, 63, 75, 255) );
  QCOMPARE( palette->getColor( 31 ), QColor(65, 67, 94, 255) );
  QCOMPARE( palette->getColor( 32 ), QColor(189, 16, 24, 255) );
  QCOMPARE( palette->getColor( 33 ), QColor(101, 62, 16, 255) );
  QCOMPARE( palette->getColor( 34 ), QColor(103, 56, 30, 255) );
  QCOMPARE( palette->getColor( 35 ), QColor(181, 16, 24, 255) );
  QCOMPARE( palette->getColor( 36 ), QColor(181, 16, 16, 255) );
  QCOMPARE( palette->getColor( 37 ), QColor(173, 16, 24, 255) );
  QCOMPARE( palette->getColor( 38 ), QColor(173, 16, 16, 255) );
  QCOMPARE( palette->getColor( 39 ), QColor(165, 16, 24, 255) );
  QCOMPARE( palette->getColor( 40 ), QColor(62, 58, 78, 255) );
  QCOMPARE( palette->getColor( 41 ), QColor(165, 16, 16, 255) );
  QCOMPARE( palette->getColor( 42 ), QColor(156, 16, 24, 255) );
  QCOMPARE( palette->getColor( 43 ), QColor(54, 54, 93, 255) );
  QCOMPARE( palette->getColor( 44 ), QColor(156, 16, 16, 255) );
  QCOMPARE( palette->getColor( 45 ), QColor(78, 50, 28, 255) );
  QCOMPARE( palette->getColor( 46 ), QColor(165, 8, 16, 255) );
  QCOMPARE( palette->getColor( 47 ), QColor(67, 52, 46, 255) );
  QCOMPARE( palette->getColor( 48 ), QColor(61, 48, 64, 255) );
  QCOMPARE( palette->getColor( 49 ), QColor(81, 41, 45, 255) );
  QCOMPARE( palette->getColor( 50 ), QColor(156, 8, 16, 255) );
  QCOMPARE( palette->getColor( 51 ), QColor(145, 12, 17, 255) );
  QCOMPARE( palette->getColor( 52 ), QColor(47, 50, 73, 255) );
  QCOMPARE( palette->getColor( 53 ), QColor(73, 46, 16, 255) );
  QCOMPARE( palette->getColor( 54 ), QColor(46, 49, 44, 255) );
  QCOMPARE( palette->getColor( 55 ), QColor(129, 12, 16, 255) );
  QCOMPARE( palette->getColor( 56 ), QColor(47, 49, 33, 255) );
  QCOMPARE( palette->getColor( 57 ), QColor(57, 41, 45, 255) );
  QCOMPARE( palette->getColor( 58 ), QColor(105, 19, 20, 255) );
  QCOMPARE( palette->getColor( 59 ), QColor(43, 41, 71, 255) );
  QCOMPARE( palette->getColor( 60 ), QColor(49, 41, 41, 255) );
  QCOMPARE( palette->getColor( 61 ), QColor(45, 41, 49, 255) );
  QCOMPARE( palette->getColor( 62 ), QColor(43, 40, 57, 255) );
  QCOMPARE( palette->getColor( 63 ), QColor(52, 41, 20, 255) );
  QCOMPARE( palette->getColor( 64 ), QColor(120, 8, 8, 255) );
  QCOMPARE( palette->getColor( 65 ), QColor(59, 32, 42, 255) );
  QCOMPARE( palette->getColor( 66 ), QColor(44, 41, 33, 255) );
  QCOMPARE( palette->getColor( 67 ), QColor(41, 41, 41, 255) );
  QCOMPARE( palette->getColor( 68 ), QColor(68, 26, 26, 255) );
  QCOMPARE( palette->getColor( 69 ), QColor(33, 41, 41, 255) );
  QCOMPARE( palette->getColor( 70 ), QColor(49, 33, 33, 255) );
  QCOMPARE( palette->getColor( 71 ), QColor(33, 41, 33, 255) );
  QCOMPARE( palette->getColor( 72 ), QColor(107, 8, 8, 255) );
  QCOMPARE( palette->getColor( 73 ), QColor(41, 33, 49, 255) );
  QCOMPARE( palette->getColor( 74 ), QColor(33, 41, 24, 255) );
  QCOMPARE( palette->getColor( 75 ), QColor(27, 35, 70, 255) );
  QCOMPARE( palette->getColor( 76 ), QColor(41, 33, 41, 255) );
  QCOMPARE( palette->getColor( 77 ), QColor(41, 33, 33, 255) );
  QCOMPARE( palette->getColor( 78 ), QColor(44, 33, 24, 255) );
  QCOMPARE( palette->getColor( 79 ), QColor(99, 8, 8, 255) );
  QCOMPARE( palette->getColor( 80 ), QColor(46, 33, 12, 255) );
  QCOMPARE( palette->getColor( 81 ), QColor(32, 33, 49, 255) );
  QCOMPARE( palette->getColor( 82 ), QColor(33, 33, 41, 255) );
  QCOMPARE( palette->getColor( 83 ), QColor(33, 33, 33, 255) );
  QCOMPARE( palette->getColor( 84 ), QColor(87, 10, 8, 255) );
  QCOMPARE( palette->getColor( 85 ), QColor(33, 33, 24, 255) );
  QCOMPARE( palette->getColor( 86 ), QColor(24, 33, 41, 255) );
  QCOMPARE( palette->getColor( 87 ), QColor(33, 33, 16, 255) );
  QCOMPARE( palette->getColor( 88 ), QColor(41, 24, 42, 255) );
  QCOMPARE( palette->getColor( 89 ), QColor(44, 24, 33, 255) );
  QCOMPARE( palette->getColor( 90 ), QColor(24, 33, 33, 255) );
  QCOMPARE( palette->getColor( 91 ), QColor(25, 28, 57, 255) );
  QCOMPARE( palette->getColor( 92 ), QColor(33, 33, 8, 255) );
  QCOMPARE( palette->getColor( 93 ), QColor(24, 33, 24, 255) );
  QCOMPARE( palette->getColor( 94 ), QColor(24, 33, 14, 255) );
  QCOMPARE( palette->getColor( 95 ), QColor(33, 24, 33, 255) );
  QCOMPARE( palette->getColor( 96 ), QColor(43, 21, 18, 255) );
  QCOMPARE( palette->getColor( 97 ), QColor(33, 24, 24, 255) );
  QCOMPARE( palette->getColor( 98 ), QColor(33, 24, 16, 255) );
  QCOMPARE( palette->getColor( 99 ), QColor(19, 24, 49, 255) );
  QCOMPARE( palette->getColor( 100 ), QColor(24, 24, 33, 255) );
  QCOMPARE( palette->getColor( 101 ), QColor(25, 22, 41, 255) );
  QCOMPARE( palette->getColor( 102 ), QColor(24, 24, 24, 255) );
  QCOMPARE( palette->getColor( 103 ), QColor(24, 24, 16, 255) );
  QCOMPARE( palette->getColor( 104 ), QColor(16, 24, 24, 255) );
  QCOMPARE( palette->getColor( 105 ), QColor(16, 24, 16, 255) );
  QCOMPARE( palette->getColor( 106 ), QColor(24, 16, 33, 255) );
  QCOMPARE( palette->getColor( 107 ), QColor(67, 0, 1, 255) );
  QCOMPARE( palette->getColor( 108 ), QColor(28, 18, 6, 255) );
  QCOMPARE( palette->getColor( 109 ), QColor(25, 16, 24, 255) );
  QCOMPARE( palette->getColor( 110 ), QColor(15, 18, 33, 255) );
  QCOMPARE( palette->getColor( 111 ), QColor(25, 16, 16, 255) );
  QCOMPARE( palette->getColor( 112 ), QColor(16, 16, 24, 255) );
  QCOMPARE( palette->getColor( 113 ), QColor(16, 16, 16, 255) );
  QCOMPARE( palette->getColor( 114 ), QColor(16, 16, 8, 255) );
  QCOMPARE( palette->getColor( 115 ), QColor(8, 16, 16, 255) );
  QCOMPARE( palette->getColor( 116 ), QColor(8, 16, 8, 255) );
  QCOMPARE( palette->getColor( 117 ), QColor(16, 8, 24, 255) );
  QCOMPARE( palette->getColor( 118 ), QColor(17, 8, 16, 255) );
  QCOMPARE( palette->getColor( 119 ), QColor(8, 11, 24, 255) );
  QCOMPARE( palette->getColor( 120 ), QColor(17, 8, 7, 255) );
  QCOMPARE( palette->getColor( 121 ), QColor(8, 8, 16, 255) );
  QCOMPARE( palette->getColor( 122 ), QColor(8, 8, 8, 255) );
  QCOMPARE( palette->getColor( 123 ), QColor(8, 8, 0, 255) );
  QCOMPARE( palette->getColor( 124 ), QColor(0, 8, 8, 255) );
  QCOMPARE( palette->getColor( 125 ), QColor(8, 0, 0, 255) );
  QCOMPARE( palette->getColor( 126 ), QColor(4, 0, 8, 255) );
  QCOMPARE( palette->getColor( 127 ), QColor(0, 0, 0, 255) );
  QCOMPARE( palette->getColor( 128 ), QColor(159, 159, 255, 255) );
  QCOMPARE( palette->getColor( 129 ), QColor(87, 87, 255, 255) );
  QCOMPARE( palette->getColor( 130 ), QColor(36, 36, 254, 255) );
  QCOMPARE( palette->getColor( 131 ), QColor(1, 1, 239, 255) );
  QCOMPARE( palette->getColor( 132 ), QColor(0, 0, 189, 255) );
  QCOMPARE( palette->getColor( 133 ), QColor(0, 0, 138, 255) );
  QCOMPARE( palette->getColor( 134 ), QColor(0, 0, 87, 255) );
  QCOMPARE( palette->getColor( 135 ), QColor(0, 0, 25, 255) );
  QCOMPARE( palette->getColor( 136 ), QColor(255, 159, 159, 255) );
  QCOMPARE( palette->getColor( 137 ), QColor(255, 87, 87, 255) );
  QCOMPARE( palette->getColor( 138 ), QColor(254, 36, 36, 255) );
  QCOMPARE( palette->getColor( 139 ), QColor(240, 0, 0, 255) );
  QCOMPARE( palette->getColor( 140 ), QColor(189, 0, 0, 255) );
  QCOMPARE( palette->getColor( 141 ), QColor(145, 0, 0, 255) );
  QCOMPARE( palette->getColor( 142 ), QColor(90, 0, 0, 255) );
  QCOMPARE( palette->getColor( 143 ), QColor(35, 0, 0, 255) );
  QCOMPARE( palette->getColor( 144 ), QColor(255, 253, 159, 255) );
  QCOMPARE( palette->getColor( 145 ), QColor(255, 252, 87, 255) );
  QCOMPARE( palette->getColor( 146 ), QColor(254, 251, 36, 255) );
  QCOMPARE( palette->getColor( 147 ), QColor(240, 236, 0, 255) );
  QCOMPARE( palette->getColor( 148 ), QColor(195, 195, 0, 255) );
  QCOMPARE( palette->getColor( 149 ), QColor(134, 134, 0, 255) );
  QCOMPARE( palette->getColor( 150 ), QColor(87, 85, 0, 255) );
  QCOMPARE( palette->getColor( 151 ), QColor(25, 25, 0, 255) );
  QCOMPARE( palette->getColor( 152 ), QColor(254, 190, 160, 255) );
  QCOMPARE( palette->getColor( 153 ), QColor(255, 140, 87, 255) );
  QCOMPARE( palette->getColor( 154 ), QColor(254, 105, 36, 255) );
  QCOMPARE( palette->getColor( 155 ), QColor(240, 76, 0, 255) );
  QCOMPARE( palette->getColor( 156 ), QColor(199, 65, 0, 255) );
  QCOMPARE( palette->getColor( 157 ), QColor(143, 46, 0, 255) );
  QCOMPARE( palette->getColor( 158 ), QColor(87, 26, 0, 255) );
  QCOMPARE( palette->getColor( 159 ), QColor(30, 7, 0, 255) );
  QCOMPARE( palette->getColor( 160 ), QColor(232, 202, 202, 255) );
  QCOMPARE( palette->getColor( 161 ), QColor(215, 178, 178, 255) );
  QCOMPARE( palette->getColor( 162 ), QColor(202, 158, 158, 255) );
  QCOMPARE( palette->getColor( 163 ), QColor(189, 143, 143, 255) );
  QCOMPARE( palette->getColor( 164 ), QColor(179, 128, 128, 255) );
  QCOMPARE( palette->getColor( 165 ), QColor(168, 113, 113, 255) );
  QCOMPARE( palette->getColor( 166 ), QColor(165, 90, 90, 255) );
  QCOMPARE( palette->getColor( 167 ), QColor(156, 73, 73, 255) );
  QCOMPARE( palette->getColor( 168 ), QColor(139, 65, 65, 255) );
  QCOMPARE( palette->getColor( 169 ), QColor(121, 57, 57, 255) );
  QCOMPARE( palette->getColor( 170 ), QColor(104, 49, 49, 255) );
  QCOMPARE( palette->getColor( 171 ), QColor(86, 41, 41, 255) );
  QCOMPARE( palette->getColor( 172 ), QColor(68, 33, 33, 255) );
  QCOMPARE( palette->getColor( 173 ), QColor(51, 25, 25, 255) );
  QCOMPARE( palette->getColor( 174 ), QColor(27, 14, 14, 255) );
  QCOMPARE( palette->getColor( 175 ), QColor(12, 7, 7, 255) );
  QCOMPARE( palette->getColor( 176 ), QColor(200, 205, 234, 255) );
  QCOMPARE( palette->getColor( 177 ), QColor(178, 183, 215, 255) );
  QCOMPARE( palette->getColor( 178 ), QColor(159, 165, 198, 255) );
  QCOMPARE( palette->getColor( 179 ), QColor(147, 153, 185, 255) );
  QCOMPARE( palette->getColor( 180 ), QColor(135, 141, 172, 255) );
  QCOMPARE( palette->getColor( 181 ), QColor(121, 127, 160, 255) );
  QCOMPARE( palette->getColor( 182 ), QColor(102, 112, 153, 255) );
  QCOMPARE( palette->getColor( 183 ), QColor(88, 99, 141, 255) );
  QCOMPARE( palette->getColor( 184 ), QColor(78, 88, 125, 255) );
  QCOMPARE( palette->getColor( 185 ), QColor(67, 76, 111, 255) );
  QCOMPARE( palette->getColor( 186 ), QColor(57, 65, 95, 255) );
  QCOMPARE( palette->getColor( 187 ), QColor(47, 54, 80, 255) );
  QCOMPARE( palette->getColor( 188 ), QColor(37, 43, 65, 255) );
  QCOMPARE( palette->getColor( 189 ), QColor(25, 30, 45, 255) );
  QCOMPARE( palette->getColor( 190 ), QColor(13, 17, 27, 255) );
  QCOMPARE( palette->getColor( 191 ), QColor(5, 7, 12, 255) );
  QCOMPARE( palette->getColor( 192 ), QColor(255, 227, 164, 255) );
  QCOMPARE( palette->getColor( 193 ), QColor(238, 209, 140, 255) );
  QCOMPARE( palette->getColor( 194 ), QColor(221, 196, 126, 255) );
  QCOMPARE( palette->getColor( 195 ), QColor(204, 183, 117, 255) );
  QCOMPARE( palette->getColor( 196 ), QColor(188, 168, 108, 255) );
  QCOMPARE( palette->getColor( 197 ), QColor(171, 154, 99, 255) );
  QCOMPARE( palette->getColor( 198 ), QColor(152, 139, 93, 255) );
  QCOMPARE( palette->getColor( 199 ), QColor(135, 126, 84, 255) );
  QCOMPARE( palette->getColor( 200 ), QColor(120, 111, 73, 255) );
  QCOMPARE( palette->getColor( 201 ), QColor(105, 96, 63, 255) );
  QCOMPARE( palette->getColor( 202 ), QColor(91, 81, 52, 255) );
  QCOMPARE( palette->getColor( 203 ), QColor(72, 64, 39, 255) );
  QCOMPARE( palette->getColor( 204 ), QColor(57, 49, 29, 255) );
  QCOMPARE( palette->getColor( 205 ), QColor(49, 40, 22, 255) );
  QCOMPARE( palette->getColor( 206 ), QColor(26, 20, 8, 255) );
  QCOMPARE( palette->getColor( 207 ), QColor(20, 11, 0, 255) );
  QCOMPARE( palette->getColor( 208 ), QColor(255, 226, 179, 255) );
  QCOMPARE( palette->getColor( 209 ), QColor(244, 201, 150, 255) );
  QCOMPARE( palette->getColor( 210 ), QColor(231, 179, 126, 255) );
  QCOMPARE( palette->getColor( 211 ), QColor(220, 159, 112, 255) );
  QCOMPARE( palette->getColor( 212 ), QColor(208, 140, 98, 255) );
  QCOMPARE( palette->getColor( 213 ), QColor(199, 123, 82, 255) );
  QCOMPARE( palette->getColor( 214 ), QColor(204, 97, 51, 255) );
  QCOMPARE( palette->getColor( 215 ), QColor(199, 75, 31, 255) );
  QCOMPARE( palette->getColor( 216 ), QColor(177, 67, 27, 255) );
  QCOMPARE( palette->getColor( 217 ), QColor(155, 59, 24, 255) );
  QCOMPARE( palette->getColor( 218 ), QColor(133, 50, 19, 255) );
  QCOMPARE( palette->getColor( 219 ), QColor(111, 41, 16, 255) );
  QCOMPARE( palette->getColor( 220 ), QColor(90, 34, 12, 255) );
  QCOMPARE( palette->getColor( 221 ), QColor(63, 23, 8, 255) );
  QCOMPARE( palette->getColor( 222 ), QColor(37, 14, 3, 255) );
  QCOMPARE( palette->getColor( 223 ), QColor(15, 5, 0, 255) );
  QCOMPARE( palette->getColor( 224 ), QColor(255, 189, 189, 255) );
  QCOMPARE( palette->getColor( 225 ), QColor(244, 150, 150, 255) );
  QCOMPARE( palette->getColor( 226 ), QColor(232, 125, 125, 255) );
  QCOMPARE( palette->getColor( 227 ), QColor(224, 108, 108, 255) );
  QCOMPARE( palette->getColor( 228 ), QColor(216, 91, 91, 255) );
  QCOMPARE( palette->getColor( 229 ), QColor(207, 73, 73, 255) );
  QCOMPARE( palette->getColor( 230 ), QColor(199, 56, 56, 255) );
  QCOMPARE( palette->getColor( 231 ), QColor(191, 39, 39, 255) );
  QCOMPARE( palette->getColor( 232 ), QColor(169, 34, 34, 255) );
  QCOMPARE( palette->getColor( 233 ), QColor(147, 30, 30, 255) );
  QCOMPARE( palette->getColor( 234 ), QColor(124, 25, 25, 255) );
  QCOMPARE( palette->getColor( 235 ), QColor(102, 21, 21, 255) );
  QCOMPARE( palette->getColor( 236 ), QColor(79, 17, 17, 255) );
  QCOMPARE( palette->getColor( 237 ), QColor(57, 13, 13, 255) );
  QCOMPARE( palette->getColor( 238 ), QColor(35, 9, 9, 255) );
  QCOMPARE( palette->getColor( 239 ), QColor(12, 5, 5, 255) );
  QCOMPARE( palette->getColor( 240 ), QColor(243, 243, 243, 255) );
  QCOMPARE( palette->getColor( 241 ), QColor(222, 222, 222, 255) );
  QCOMPARE( palette->getColor( 242 ), QColor(204, 204, 204, 255) );
  QCOMPARE( palette->getColor( 243 ), QColor(184, 184, 184, 255) );
  QCOMPARE( palette->getColor( 244 ), QColor(163, 163, 163, 255) );
  QCOMPARE( palette->getColor( 245 ), QColor(148, 148, 148, 255) );
  QCOMPARE( palette->getColor( 246 ), QColor(133, 133, 133, 255) );
  QCOMPARE( palette->getColor( 247 ), QColor(115, 115, 115, 255) );
  QCOMPARE( palette->getColor( 248 ), QColor(102, 102, 102, 255) );
  QCOMPARE( palette->getColor( 249 ), QColor(89, 89, 89, 255) );
  QCOMPARE( palette->getColor( 250 ), QColor(76, 76, 76, 255) );
  QCOMPARE( palette->getColor( 251 ), QColor(61, 61, 61, 255) );
  QCOMPARE( palette->getColor( 252 ), QColor(46, 46, 46, 255) );
  QCOMPARE( palette->getColor( 253 ), QColor(30, 30, 30, 255) );
  QCOMPARE( palette->getColor( 254 ), QColor(17, 17, 17, 255) );
  QCOMPARE( palette->getColor( 255 ), QColor(Qt::transparent) );

  // Advanced constructor
  QFile palette_file( "/levels/towndata/town.pal" );
  palette_file.open( QIODevice::ReadOnly );
  
  QByteArray palette_data( palette_file.size(), 0 );
  palette_file.read( palette_data.data(), palette_data.size() );
  
  palette.reset( new QtD1::CelPalette( "/levels/towndata/town.pal", palette_data ) );

  QCOMPARE( palette->getColor( 0 ), QColor(0, 0, 0, 255) );
  QCOMPARE( palette->getColor( 1 ), QColor(181, 93, 27, 255) );
  QCOMPARE( palette->getColor( 2 ), QColor(165, 93, 54, 255) );
  QCOMPARE( palette->getColor( 3 ), QColor(165, 85, 24, 255) );
  QCOMPARE( palette->getColor( 4 ), QColor(152, 86, 49, 255) );
  QCOMPARE( palette->getColor( 5 ), QColor(143, 86, 59, 255) );
  QCOMPARE( palette->getColor( 6 ), QColor(156, 84, 29, 255) );
  QCOMPARE( palette->getColor( 7 ), QColor(141, 88, 27, 255) );
  QCOMPARE( palette->getColor( 8 ), QColor(145, 82, 41, 255) );
  QCOMPARE( palette->getColor( 9 ), QColor(139, 82, 49, 255) );
  QCOMPARE( palette->getColor( 10 ), QColor(132, 73, 44, 255) );
  QCOMPARE( palette->getColor( 11 ), QColor(161, 62, 18, 255) );
  QCOMPARE( palette->getColor( 12 ), QColor(145, 66, 39, 255) );
  QCOMPARE( palette->getColor( 13 ), QColor(82, 83, 117, 255) );
  QCOMPARE( palette->getColor( 14 ), QColor(136, 70, 17, 255) );
  QCOMPARE( palette->getColor( 15 ), QColor(120, 69, 51, 255) );
  QCOMPARE( palette->getColor( 16 ), QColor(116, 74, 24, 255) );
  QCOMPARE( palette->getColor( 17 ), QColor(120, 66, 41, 255) );
  QCOMPARE( palette->getColor( 18 ), QColor(204, 24, 33, 255) );
  QCOMPARE( palette->getColor( 19 ), QColor(107, 74, 24, 255) );
  QCOMPARE( palette->getColor( 20 ), QColor(78, 74, 99, 255) );
  QCOMPARE( palette->getColor( 21 ), QColor(120, 64, 26, 255) );
  QCOMPARE( palette->getColor( 22 ), QColor(73, 71, 110, 255) );
  QCOMPARE( palette->getColor( 23 ), QColor(206, 16, 32, 255) );
  QCOMPARE( palette->getColor( 24 ), QColor(107, 66, 24, 255) );
  QCOMPARE( palette->getColor( 25 ), QColor(198, 16, 33, 255) );
  QCOMPARE( palette->getColor( 26 ), QColor(78, 66, 92, 255) );
  QCOMPARE( palette->getColor( 27 ), QColor(198, 16, 24, 255) );
  QCOMPARE( palette->getColor( 28 ), QColor(99, 66, 24, 255) );
  QCOMPARE( palette->getColor( 29 ), QColor(101, 61, 44, 255) );
  QCOMPARE( palette->getColor( 30 ), QColor(83, 63, 75, 255) );
  QCOMPARE( palette->getColor( 31 ), QColor(65, 67, 94, 255) );
  QCOMPARE( palette->getColor( 32 ), QColor(189, 16, 24, 255) );
  QCOMPARE( palette->getColor( 33 ), QColor(101, 62, 16, 255) );
  QCOMPARE( palette->getColor( 34 ), QColor(103, 56, 30, 255) );
  QCOMPARE( palette->getColor( 35 ), QColor(181, 16, 24, 255) );
  QCOMPARE( palette->getColor( 36 ), QColor(181, 16, 16, 255) );
  QCOMPARE( palette->getColor( 37 ), QColor(173, 16, 24, 255) );
  QCOMPARE( palette->getColor( 38 ), QColor(173, 16, 16, 255) );
  QCOMPARE( palette->getColor( 39 ), QColor(165, 16, 24, 255) );
  QCOMPARE( palette->getColor( 40 ), QColor(62, 58, 78, 255) );
  QCOMPARE( palette->getColor( 41 ), QColor(165, 16, 16, 255) );
  QCOMPARE( palette->getColor( 42 ), QColor(156, 16, 24, 255) );
  QCOMPARE( palette->getColor( 43 ), QColor(54, 54, 93, 255) );
  QCOMPARE( palette->getColor( 44 ), QColor(156, 16, 16, 255) );
  QCOMPARE( palette->getColor( 45 ), QColor(78, 50, 28, 255) );
  QCOMPARE( palette->getColor( 46 ), QColor(165, 8, 16, 255) );
  QCOMPARE( palette->getColor( 47 ), QColor(67, 52, 46, 255) );
  QCOMPARE( palette->getColor( 48 ), QColor(61, 48, 64, 255) );
  QCOMPARE( palette->getColor( 49 ), QColor(81, 41, 45, 255) );
  QCOMPARE( palette->getColor( 50 ), QColor(156, 8, 16, 255) );
  QCOMPARE( palette->getColor( 51 ), QColor(145, 12, 17, 255) );
  QCOMPARE( palette->getColor( 52 ), QColor(47, 50, 73, 255) );
  QCOMPARE( palette->getColor( 53 ), QColor(73, 46, 16, 255) );
  QCOMPARE( palette->getColor( 54 ), QColor(46, 49, 44, 255) );
  QCOMPARE( palette->getColor( 55 ), QColor(129, 12, 16, 255) );
  QCOMPARE( palette->getColor( 56 ), QColor(47, 49, 33, 255) );
  QCOMPARE( palette->getColor( 57 ), QColor(57, 41, 45, 255) );
  QCOMPARE( palette->getColor( 58 ), QColor(105, 19, 20, 255) );
  QCOMPARE( palette->getColor( 59 ), QColor(43, 41, 71, 255) );
  QCOMPARE( palette->getColor( 60 ), QColor(49, 41, 41, 255) );
  QCOMPARE( palette->getColor( 61 ), QColor(45, 41, 49, 255) );
  QCOMPARE( palette->getColor( 62 ), QColor(43, 40, 57, 255) );
  QCOMPARE( palette->getColor( 63 ), QColor(52, 41, 20, 255) );
  QCOMPARE( palette->getColor( 64 ), QColor(120, 8, 8, 255) );
  QCOMPARE( palette->getColor( 65 ), QColor(59, 32, 42, 255) );
  QCOMPARE( palette->getColor( 66 ), QColor(44, 41, 33, 255) );
  QCOMPARE( palette->getColor( 67 ), QColor(41, 41, 41, 255) );
  QCOMPARE( palette->getColor( 68 ), QColor(68, 26, 26, 255) );
  QCOMPARE( palette->getColor( 69 ), QColor(33, 41, 41, 255) );
  QCOMPARE( palette->getColor( 70 ), QColor(49, 33, 33, 255) );
  QCOMPARE( palette->getColor( 71 ), QColor(33, 41, 33, 255) );
  QCOMPARE( palette->getColor( 72 ), QColor(107, 8, 8, 255) );
  QCOMPARE( palette->getColor( 73 ), QColor(41, 33, 49, 255) );
  QCOMPARE( palette->getColor( 74 ), QColor(33, 41, 24, 255) );
  QCOMPARE( palette->getColor( 75 ), QColor(27, 35, 70, 255) );
  QCOMPARE( palette->getColor( 76 ), QColor(41, 33, 41, 255) );
  QCOMPARE( palette->getColor( 77 ), QColor(41, 33, 33, 255) );
  QCOMPARE( palette->getColor( 78 ), QColor(44, 33, 24, 255) );
  QCOMPARE( palette->getColor( 79 ), QColor(99, 8, 8, 255) );
  QCOMPARE( palette->getColor( 80 ), QColor(46, 33, 12, 255) );
  QCOMPARE( palette->getColor( 81 ), QColor(32, 33, 49, 255) );
  QCOMPARE( palette->getColor( 82 ), QColor(33, 33, 41, 255) );
  QCOMPARE( palette->getColor( 83 ), QColor(33, 33, 33, 255) );
  QCOMPARE( palette->getColor( 84 ), QColor(87, 10, 8, 255) );
  QCOMPARE( palette->getColor( 85 ), QColor(33, 33, 24, 255) );
  QCOMPARE( palette->getColor( 86 ), QColor(24, 33, 41, 255) );
  QCOMPARE( palette->getColor( 87 ), QColor(33, 33, 16, 255) );
  QCOMPARE( palette->getColor( 88 ), QColor(41, 24, 42, 255) );
  QCOMPARE( palette->getColor( 89 ), QColor(44, 24, 33, 255) );
  QCOMPARE( palette->getColor( 90 ), QColor(24, 33, 33, 255) );
  QCOMPARE( palette->getColor( 91 ), QColor(25, 28, 57, 255) );
  QCOMPARE( palette->getColor( 92 ), QColor(33, 33, 8, 255) );
  QCOMPARE( palette->getColor( 93 ), QColor(24, 33, 24, 255) );
  QCOMPARE( palette->getColor( 94 ), QColor(24, 33, 14, 255) );
  QCOMPARE( palette->getColor( 95 ), QColor(33, 24, 33, 255) );
  QCOMPARE( palette->getColor( 96 ), QColor(43, 21, 18, 255) );
  QCOMPARE( palette->getColor( 97 ), QColor(33, 24, 24, 255) );
  QCOMPARE( palette->getColor( 98 ), QColor(33, 24, 16, 255) );
  QCOMPARE( palette->getColor( 99 ), QColor(19, 24, 49, 255) );
  QCOMPARE( palette->getColor( 100 ), QColor(24, 24, 33, 255) );
  QCOMPARE( palette->getColor( 101 ), QColor(25, 22, 41, 255) );
  QCOMPARE( palette->getColor( 102 ), QColor(24, 24, 24, 255) );
  QCOMPARE( palette->getColor( 103 ), QColor(24, 24, 16, 255) );
  QCOMPARE( palette->getColor( 104 ), QColor(16, 24, 24, 255) );
  QCOMPARE( palette->getColor( 105 ), QColor(16, 24, 16, 255) );
  QCOMPARE( palette->getColor( 106 ), QColor(24, 16, 33, 255) );
  QCOMPARE( palette->getColor( 107 ), QColor(67, 0, 1, 255) );
  QCOMPARE( palette->getColor( 108 ), QColor(28, 18, 6, 255) );
  QCOMPARE( palette->getColor( 109 ), QColor(25, 16, 24, 255) );
  QCOMPARE( palette->getColor( 110 ), QColor(15, 18, 33, 255) );
  QCOMPARE( palette->getColor( 111 ), QColor(25, 16, 16, 255) );
  QCOMPARE( palette->getColor( 112 ), QColor(16, 16, 24, 255) );
  QCOMPARE( palette->getColor( 113 ), QColor(16, 16, 16, 255) );
  QCOMPARE( palette->getColor( 114 ), QColor(16, 16, 8, 255) );
  QCOMPARE( palette->getColor( 115 ), QColor(8, 16, 16, 255) );
  QCOMPARE( palette->getColor( 116 ), QColor(8, 16, 8, 255) );
  QCOMPARE( palette->getColor( 117 ), QColor(16, 8, 24, 255) );
  QCOMPARE( palette->getColor( 118 ), QColor(17, 8, 16, 255) );
  QCOMPARE( palette->getColor( 119 ), QColor(8, 11, 24, 255) );
  QCOMPARE( palette->getColor( 120 ), QColor(17, 8, 7, 255) );
  QCOMPARE( palette->getColor( 121 ), QColor(8, 8, 16, 255) );
  QCOMPARE( palette->getColor( 122 ), QColor(8, 8, 8, 255) );
  QCOMPARE( palette->getColor( 123 ), QColor(8, 8, 0, 255) );
  QCOMPARE( palette->getColor( 124 ), QColor(0, 8, 8, 255) );
  QCOMPARE( palette->getColor( 125 ), QColor(8, 0, 0, 255) );
  QCOMPARE( palette->getColor( 126 ), QColor(4, 0, 8, 255) );
  QCOMPARE( palette->getColor( 127 ), QColor(0, 0, 0, 255) );
  QCOMPARE( palette->getColor( 128 ), QColor(159, 159, 255, 255) );
  QCOMPARE( palette->getColor( 129 ), QColor(87, 87, 255, 255) );
  QCOMPARE( palette->getColor( 130 ), QColor(36, 36, 254, 255) );
  QCOMPARE( palette->getColor( 131 ), QColor(1, 1, 239, 255) );
  QCOMPARE( palette->getColor( 132 ), QColor(0, 0, 189, 255) );
  QCOMPARE( palette->getColor( 133 ), QColor(0, 0, 138, 255) );
  QCOMPARE( palette->getColor( 134 ), QColor(0, 0, 87, 255) );
  QCOMPARE( palette->getColor( 135 ), QColor(0, 0, 25, 255) );
  QCOMPARE( palette->getColor( 136 ), QColor(255, 159, 159, 255) );
  QCOMPARE( palette->getColor( 137 ), QColor(255, 87, 87, 255) );
  QCOMPARE( palette->getColor( 138 ), QColor(254, 36, 36, 255) );
  QCOMPARE( palette->getColor( 139 ), QColor(240, 0, 0, 255) );
  QCOMPARE( palette->getColor( 140 ), QColor(189, 0, 0, 255) );
  QCOMPARE( palette->getColor( 141 ), QColor(145, 0, 0, 255) );
  QCOMPARE( palette->getColor( 142 ), QColor(90, 0, 0, 255) );
  QCOMPARE( palette->getColor( 143 ), QColor(35, 0, 0, 255) );
  QCOMPARE( palette->getColor( 144 ), QColor(255, 253, 159, 255) );
  QCOMPARE( palette->getColor( 145 ), QColor(255, 252, 87, 255) );
  QCOMPARE( palette->getColor( 146 ), QColor(254, 251, 36, 255) );
  QCOMPARE( palette->getColor( 147 ), QColor(240, 236, 0, 255) );
  QCOMPARE( palette->getColor( 148 ), QColor(195, 195, 0, 255) );
  QCOMPARE( palette->getColor( 149 ), QColor(134, 134, 0, 255) );
  QCOMPARE( palette->getColor( 150 ), QColor(87, 85, 0, 255) );
  QCOMPARE( palette->getColor( 151 ), QColor(25, 25, 0, 255) );
  QCOMPARE( palette->getColor( 152 ), QColor(254, 190, 160, 255) );
  QCOMPARE( palette->getColor( 153 ), QColor(255, 140, 87, 255) );
  QCOMPARE( palette->getColor( 154 ), QColor(254, 105, 36, 255) );
  QCOMPARE( palette->getColor( 155 ), QColor(240, 76, 0, 255) );
  QCOMPARE( palette->getColor( 156 ), QColor(199, 65, 0, 255) );
  QCOMPARE( palette->getColor( 157 ), QColor(143, 46, 0, 255) );
  QCOMPARE( palette->getColor( 158 ), QColor(87, 26, 0, 255) );
  QCOMPARE( palette->getColor( 159 ), QColor(30, 7, 0, 255) );
  QCOMPARE( palette->getColor( 160 ), QColor(232, 202, 202, 255) );
  QCOMPARE( palette->getColor( 161 ), QColor(215, 178, 178, 255) );
  QCOMPARE( palette->getColor( 162 ), QColor(202, 158, 158, 255) );
  QCOMPARE( palette->getColor( 163 ), QColor(189, 143, 143, 255) );
  QCOMPARE( palette->getColor( 164 ), QColor(179, 128, 128, 255) );
  QCOMPARE( palette->getColor( 165 ), QColor(168, 113, 113, 255) );
  QCOMPARE( palette->getColor( 166 ), QColor(165, 90, 90, 255) );
  QCOMPARE( palette->getColor( 167 ), QColor(156, 73, 73, 255) );
  QCOMPARE( palette->getColor( 168 ), QColor(139, 65, 65, 255) );
  QCOMPARE( palette->getColor( 169 ), QColor(121, 57, 57, 255) );
  QCOMPARE( palette->getColor( 170 ), QColor(104, 49, 49, 255) );
  QCOMPARE( palette->getColor( 171 ), QColor(86, 41, 41, 255) );
  QCOMPARE( palette->getColor( 172 ), QColor(68, 33, 33, 255) );
  QCOMPARE( palette->getColor( 173 ), QColor(51, 25, 25, 255) );
  QCOMPARE( palette->getColor( 174 ), QColor(27, 14, 14, 255) );
  QCOMPARE( palette->getColor( 175 ), QColor(12, 7, 7, 255) );
  QCOMPARE( palette->getColor( 176 ), QColor(200, 205, 234, 255) );
  QCOMPARE( palette->getColor( 177 ), QColor(178, 183, 215, 255) );
  QCOMPARE( palette->getColor( 178 ), QColor(159, 165, 198, 255) );
  QCOMPARE( palette->getColor( 179 ), QColor(147, 153, 185, 255) );
  QCOMPARE( palette->getColor( 180 ), QColor(135, 141, 172, 255) );
  QCOMPARE( palette->getColor( 181 ), QColor(121, 127, 160, 255) );
  QCOMPARE( palette->getColor( 182 ), QColor(102, 112, 153, 255) );
  QCOMPARE( palette->getColor( 183 ), QColor(88, 99, 141, 255) );
  QCOMPARE( palette->getColor( 184 ), QColor(78, 88, 125, 255) );
  QCOMPARE( palette->getColor( 185 ), QColor(67, 76, 111, 255) );
  QCOMPARE( palette->getColor( 186 ), QColor(57, 65, 95, 255) );
  QCOMPARE( palette->getColor( 187 ), QColor(47, 54, 80, 255) );
  QCOMPARE( palette->getColor( 188 ), QColor(37, 43, 65, 255) );
  QCOMPARE( palette->getColor( 189 ), QColor(25, 30, 45, 255) );
  QCOMPARE( palette->getColor( 190 ), QColor(13, 17, 27, 255) );
  QCOMPARE( palette->getColor( 191 ), QColor(5, 7, 12, 255) );
  QCOMPARE( palette->getColor( 192 ), QColor(255, 227, 164, 255) );
  QCOMPARE( palette->getColor( 193 ), QColor(238, 209, 140, 255) );
  QCOMPARE( palette->getColor( 194 ), QColor(221, 196, 126, 255) );
  QCOMPARE( palette->getColor( 195 ), QColor(204, 183, 117, 255) );
  QCOMPARE( palette->getColor( 196 ), QColor(188, 168, 108, 255) );
  QCOMPARE( palette->getColor( 197 ), QColor(171, 154, 99, 255) );
  QCOMPARE( palette->getColor( 198 ), QColor(152, 139, 93, 255) );
  QCOMPARE( palette->getColor( 199 ), QColor(135, 126, 84, 255) );
  QCOMPARE( palette->getColor( 200 ), QColor(120, 111, 73, 255) );
  QCOMPARE( palette->getColor( 201 ), QColor(105, 96, 63, 255) );
  QCOMPARE( palette->getColor( 202 ), QColor(91, 81, 52, 255) );
  QCOMPARE( palette->getColor( 203 ), QColor(72, 64, 39, 255) );
  QCOMPARE( palette->getColor( 204 ), QColor(57, 49, 29, 255) );
  QCOMPARE( palette->getColor( 205 ), QColor(49, 40, 22, 255) );
  QCOMPARE( palette->getColor( 206 ), QColor(26, 20, 8, 255) );
  QCOMPARE( palette->getColor( 207 ), QColor(20, 11, 0, 255) );
  QCOMPARE( palette->getColor( 208 ), QColor(255, 226, 179, 255) );
  QCOMPARE( palette->getColor( 209 ), QColor(244, 201, 150, 255) );
  QCOMPARE( palette->getColor( 210 ), QColor(231, 179, 126, 255) );
  QCOMPARE( palette->getColor( 211 ), QColor(220, 159, 112, 255) );
  QCOMPARE( palette->getColor( 212 ), QColor(208, 140, 98, 255) );
  QCOMPARE( palette->getColor( 213 ), QColor(199, 123, 82, 255) );
  QCOMPARE( palette->getColor( 214 ), QColor(204, 97, 51, 255) );
  QCOMPARE( palette->getColor( 215 ), QColor(199, 75, 31, 255) );
  QCOMPARE( palette->getColor( 216 ), QColor(177, 67, 27, 255) );
  QCOMPARE( palette->getColor( 217 ), QColor(155, 59, 24, 255) );
  QCOMPARE( palette->getColor( 218 ), QColor(133, 50, 19, 255) );
  QCOMPARE( palette->getColor( 219 ), QColor(111, 41, 16, 255) );
  QCOMPARE( palette->getColor( 220 ), QColor(90, 34, 12, 255) );
  QCOMPARE( palette->getColor( 221 ), QColor(63, 23, 8, 255) );
  QCOMPARE( palette->getColor( 222 ), QColor(37, 14, 3, 255) );
  QCOMPARE( palette->getColor( 223 ), QColor(15, 5, 0, 255) );
  QCOMPARE( palette->getColor( 224 ), QColor(255, 189, 189, 255) );
  QCOMPARE( palette->getColor( 225 ), QColor(244, 150, 150, 255) );
  QCOMPARE( palette->getColor( 226 ), QColor(232, 125, 125, 255) );
  QCOMPARE( palette->getColor( 227 ), QColor(224, 108, 108, 255) );
  QCOMPARE( palette->getColor( 228 ), QColor(216, 91, 91, 255) );
  QCOMPARE( palette->getColor( 229 ), QColor(207, 73, 73, 255) );
  QCOMPARE( palette->getColor( 230 ), QColor(199, 56, 56, 255) );
  QCOMPARE( palette->getColor( 231 ), QColor(191, 39, 39, 255) );
  QCOMPARE( palette->getColor( 232 ), QColor(169, 34, 34, 255) );
  QCOMPARE( palette->getColor( 233 ), QColor(147, 30, 30, 255) );
  QCOMPARE( palette->getColor( 234 ), QColor(124, 25, 25, 255) );
  QCOMPARE( palette->getColor( 235 ), QColor(102, 21, 21, 255) );
  QCOMPARE( palette->getColor( 236 ), QColor(79, 17, 17, 255) );
  QCOMPARE( palette->getColor( 237 ), QColor(57, 13, 13, 255) );
  QCOMPARE( palette->getColor( 238 ), QColor(35, 9, 9, 255) );
  QCOMPARE( palette->getColor( 239 ), QColor(12, 5, 5, 255) );
  QCOMPARE( palette->getColor( 240 ), QColor(243, 243, 243, 255) );
  QCOMPARE( palette->getColor( 241 ), QColor(222, 222, 222, 255) );
  QCOMPARE( palette->getColor( 242 ), QColor(204, 204, 204, 255) );
  QCOMPARE( palette->getColor( 243 ), QColor(184, 184, 184, 255) );
  QCOMPARE( palette->getColor( 244 ), QColor(163, 163, 163, 255) );
  QCOMPARE( palette->getColor( 245 ), QColor(148, 148, 148, 255) );
  QCOMPARE( palette->getColor( 246 ), QColor(133, 133, 133, 255) );
  QCOMPARE( palette->getColor( 247 ), QColor(115, 115, 115, 255) );
  QCOMPARE( palette->getColor( 248 ), QColor(102, 102, 102, 255) );
  QCOMPARE( palette->getColor( 249 ), QColor(89, 89, 89, 255) );
  QCOMPARE( palette->getColor( 250 ), QColor(76, 76, 76, 255) );
  QCOMPARE( palette->getColor( 251 ), QColor(61, 61, 61, 255) );
  QCOMPARE( palette->getColor( 252 ), QColor(46, 46, 46, 255) );
  QCOMPARE( palette->getColor( 253 ), QColor(30, 30, 30, 255) );
  QCOMPARE( palette->getColor( 254 ), QColor(17, 17, 17, 255) );
  QCOMPARE( palette->getColor( 255 ), QColor(Qt::transparent) );
}

//---------------------------------------------------------------------------//
// Check that the color corresponding to a color key can be returned
void color_operator()
{
  std::unique_ptr<QtD1::CelPalette>
    palette( new QtD1::CelPalette("/levels/towndata/town.pal") );

  QCOMPARE( (*palette)[0], QColor(0, 0, 0, 255) );
  QCOMPARE( (*palette)[1], QColor(181, 93, 27, 255) );
  QCOMPARE( (*palette)[2], QColor(165, 93, 54, 255) );
  QCOMPARE( (*palette)[3], QColor(165, 85, 24, 255) );
  QCOMPARE( (*palette)[4], QColor(152, 86, 49, 255) );
  QCOMPARE( (*palette)[5], QColor(143, 86, 59, 255) );
  QCOMPARE( (*palette)[6], QColor(156, 84, 29, 255) );
  QCOMPARE( (*palette)[7], QColor(141, 88, 27, 255) );
  QCOMPARE( (*palette)[8], QColor(145, 82, 41, 255) );
  QCOMPARE( (*palette)[9], QColor(139, 82, 49, 255) );
  QCOMPARE( (*palette)[10], QColor(132, 73, 44, 255) );
  QCOMPARE( (*palette)[11], QColor(161, 62, 18, 255) );
  QCOMPARE( (*palette)[12], QColor(145, 66, 39, 255) );
  QCOMPARE( (*palette)[13], QColor(82, 83, 117, 255) );
  QCOMPARE( (*palette)[14], QColor(136, 70, 17, 255) );
  QCOMPARE( (*palette)[15], QColor(120, 69, 51, 255) );
  QCOMPARE( (*palette)[16], QColor(116, 74, 24, 255) );
  QCOMPARE( (*palette)[17], QColor(120, 66, 41, 255) );
  QCOMPARE( (*palette)[18], QColor(204, 24, 33, 255) );
  QCOMPARE( (*palette)[19], QColor(107, 74, 24, 255) );
  QCOMPARE( (*palette)[20], QColor(78, 74, 99, 255) );
  QCOMPARE( (*palette)[21], QColor(120, 64, 26, 255) );
  QCOMPARE( (*palette)[22], QColor(73, 71, 110, 255) );
  QCOMPARE( (*palette)[23], QColor(206, 16, 32, 255) );
  QCOMPARE( (*palette)[24], QColor(107, 66, 24, 255) );
  QCOMPARE( (*palette)[25], QColor(198, 16, 33, 255) );
  QCOMPARE( (*palette)[26], QColor(78, 66, 92, 255) );
  QCOMPARE( (*palette)[27], QColor(198, 16, 24, 255) );
  QCOMPARE( (*palette)[28], QColor(99, 66, 24, 255) );
  QCOMPARE( (*palette)[29], QColor(101, 61, 44, 255) );
  QCOMPARE( (*palette)[30], QColor(83, 63, 75, 255) );
  QCOMPARE( (*palette)[31], QColor(65, 67, 94, 255) );
  QCOMPARE( (*palette)[32], QColor(189, 16, 24, 255) );
  QCOMPARE( (*palette)[33], QColor(101, 62, 16, 255) );
  QCOMPARE( (*palette)[34], QColor(103, 56, 30, 255) );
  QCOMPARE( (*palette)[35], QColor(181, 16, 24, 255) );
  QCOMPARE( (*palette)[36], QColor(181, 16, 16, 255) );
  QCOMPARE( (*palette)[37], QColor(173, 16, 24, 255) );
  QCOMPARE( (*palette)[38], QColor(173, 16, 16, 255) );
  QCOMPARE( (*palette)[39], QColor(165, 16, 24, 255) );
  QCOMPARE( (*palette)[40], QColor(62, 58, 78, 255) );
  QCOMPARE( (*palette)[41], QColor(165, 16, 16, 255) );
  QCOMPARE( (*palette)[42], QColor(156, 16, 24, 255) );
  QCOMPARE( (*palette)[43], QColor(54, 54, 93, 255) );
  QCOMPARE( (*palette)[44], QColor(156, 16, 16, 255) );
  QCOMPARE( (*palette)[45], QColor(78, 50, 28, 255) );
  QCOMPARE( (*palette)[46], QColor(165, 8, 16, 255) );
  QCOMPARE( (*palette)[47], QColor(67, 52, 46, 255) );
  QCOMPARE( (*palette)[48], QColor(61, 48, 64, 255) );
  QCOMPARE( (*palette)[49], QColor(81, 41, 45, 255) );
  QCOMPARE( (*palette)[50], QColor(156, 8, 16, 255) );
  QCOMPARE( (*palette)[51], QColor(145, 12, 17, 255) );
  QCOMPARE( (*palette)[52], QColor(47, 50, 73, 255) );
  QCOMPARE( (*palette)[53], QColor(73, 46, 16, 255) );
  QCOMPARE( (*palette)[54], QColor(46, 49, 44, 255) );
  QCOMPARE( (*palette)[55], QColor(129, 12, 16, 255) );
  QCOMPARE( (*palette)[56], QColor(47, 49, 33, 255) );
  QCOMPARE( (*palette)[57], QColor(57, 41, 45, 255) );
  QCOMPARE( (*palette)[58], QColor(105, 19, 20, 255) );
  QCOMPARE( (*palette)[59], QColor(43, 41, 71, 255) );
  QCOMPARE( (*palette)[60], QColor(49, 41, 41, 255) );
  QCOMPARE( (*palette)[61], QColor(45, 41, 49, 255) );
  QCOMPARE( (*palette)[62], QColor(43, 40, 57, 255) );
  QCOMPARE( (*palette)[63], QColor(52, 41, 20, 255) );
  QCOMPARE( (*palette)[64], QColor(120, 8, 8, 255) );
  QCOMPARE( (*palette)[65], QColor(59, 32, 42, 255) );
  QCOMPARE( (*palette)[66], QColor(44, 41, 33, 255) );
  QCOMPARE( (*palette)[67], QColor(41, 41, 41, 255) );
  QCOMPARE( (*palette)[68], QColor(68, 26, 26, 255) );
  QCOMPARE( (*palette)[69], QColor(33, 41, 41, 255) );
  QCOMPARE( (*palette)[70], QColor(49, 33, 33, 255) );
  QCOMPARE( (*palette)[71], QColor(33, 41, 33, 255) );
  QCOMPARE( (*palette)[72], QColor(107, 8, 8, 255) );
  QCOMPARE( (*palette)[73], QColor(41, 33, 49, 255) );
  QCOMPARE( (*palette)[74], QColor(33, 41, 24, 255) );
  QCOMPARE( (*palette)[75], QColor(27, 35, 70, 255) );
  QCOMPARE( (*palette)[76], QColor(41, 33, 41, 255) );
  QCOMPARE( (*palette)[77], QColor(41, 33, 33, 255) );
  QCOMPARE( (*palette)[78], QColor(44, 33, 24, 255) );
  QCOMPARE( (*palette)[79], QColor(99, 8, 8, 255) );
  QCOMPARE( (*palette)[80], QColor(46, 33, 12, 255) );
  QCOMPARE( (*palette)[81], QColor(32, 33, 49, 255) );
  QCOMPARE( (*palette)[82], QColor(33, 33, 41, 255) );
  QCOMPARE( (*palette)[83], QColor(33, 33, 33, 255) );
  QCOMPARE( (*palette)[84], QColor(87, 10, 8, 255) );
  QCOMPARE( (*palette)[85], QColor(33, 33, 24, 255) );
  QCOMPARE( (*palette)[86], QColor(24, 33, 41, 255) );
  QCOMPARE( (*palette)[87], QColor(33, 33, 16, 255) );
  QCOMPARE( (*palette)[88], QColor(41, 24, 42, 255) );
  QCOMPARE( (*palette)[89], QColor(44, 24, 33, 255) );
  QCOMPARE( (*palette)[90], QColor(24, 33, 33, 255) );
  QCOMPARE( (*palette)[91], QColor(25, 28, 57, 255) );
  QCOMPARE( (*palette)[92], QColor(33, 33, 8, 255) );
  QCOMPARE( (*palette)[93], QColor(24, 33, 24, 255) );
  QCOMPARE( (*palette)[94], QColor(24, 33, 14, 255) );
  QCOMPARE( (*palette)[95], QColor(33, 24, 33, 255) );
  QCOMPARE( (*palette)[96], QColor(43, 21, 18, 255) );
  QCOMPARE( (*palette)[97], QColor(33, 24, 24, 255) );
  QCOMPARE( (*palette)[98], QColor(33, 24, 16, 255) );
  QCOMPARE( (*palette)[99], QColor(19, 24, 49, 255) );
  QCOMPARE( (*palette)[100], QColor(24, 24, 33, 255) );
  QCOMPARE( (*palette)[101], QColor(25, 22, 41, 255) );
  QCOMPARE( (*palette)[102], QColor(24, 24, 24, 255) );
  QCOMPARE( (*palette)[103], QColor(24, 24, 16, 255) );
  QCOMPARE( (*palette)[104], QColor(16, 24, 24, 255) );
  QCOMPARE( (*palette)[105], QColor(16, 24, 16, 255) );
  QCOMPARE( (*palette)[106], QColor(24, 16, 33, 255) );
  QCOMPARE( (*palette)[107], QColor(67, 0, 1, 255) );
  QCOMPARE( (*palette)[108], QColor(28, 18, 6, 255) );
  QCOMPARE( (*palette)[109], QColor(25, 16, 24, 255) );
  QCOMPARE( (*palette)[110], QColor(15, 18, 33, 255) );
  QCOMPARE( (*palette)[111], QColor(25, 16, 16, 255) );
  QCOMPARE( (*palette)[112], QColor(16, 16, 24, 255) );
  QCOMPARE( (*palette)[113], QColor(16, 16, 16, 255) );
  QCOMPARE( (*palette)[114], QColor(16, 16, 8, 255) );
  QCOMPARE( (*palette)[115], QColor(8, 16, 16, 255) );
  QCOMPARE( (*palette)[116], QColor(8, 16, 8, 255) );
  QCOMPARE( (*palette)[117], QColor(16, 8, 24, 255) );
  QCOMPARE( (*palette)[118], QColor(17, 8, 16, 255) );
  QCOMPARE( (*palette)[119], QColor(8, 11, 24, 255) );
  QCOMPARE( (*palette)[120], QColor(17, 8, 7, 255) );
  QCOMPARE( (*palette)[121], QColor(8, 8, 16, 255) );
  QCOMPARE( (*palette)[122], QColor(8, 8, 8, 255) );
  QCOMPARE( (*palette)[123], QColor(8, 8, 0, 255) );
  QCOMPARE( (*palette)[124], QColor(0, 8, 8, 255) );
  QCOMPARE( (*palette)[125], QColor(8, 0, 0, 255) );
  QCOMPARE( (*palette)[126], QColor(4, 0, 8, 255) );
  QCOMPARE( (*palette)[127], QColor(0, 0, 0, 255) );
  QCOMPARE( (*palette)[128], QColor(159, 159, 255, 255) );
  QCOMPARE( (*palette)[129], QColor(87, 87, 255, 255) );
  QCOMPARE( (*palette)[130], QColor(36, 36, 254, 255) );
  QCOMPARE( (*palette)[131], QColor(1, 1, 239, 255) );
  QCOMPARE( (*palette)[132], QColor(0, 0, 189, 255) );
  QCOMPARE( (*palette)[133], QColor(0, 0, 138, 255) );
  QCOMPARE( (*palette)[134], QColor(0, 0, 87, 255) );
  QCOMPARE( (*palette)[135], QColor(0, 0, 25, 255) );
  QCOMPARE( (*palette)[136], QColor(255, 159, 159, 255) );
  QCOMPARE( (*palette)[137], QColor(255, 87, 87, 255) );
  QCOMPARE( (*palette)[138], QColor(254, 36, 36, 255) );
  QCOMPARE( (*palette)[139], QColor(240, 0, 0, 255) );
  QCOMPARE( (*palette)[140], QColor(189, 0, 0, 255) );
  QCOMPARE( (*palette)[141], QColor(145, 0, 0, 255) );
  QCOMPARE( (*palette)[142], QColor(90, 0, 0, 255) );
  QCOMPARE( (*palette)[143], QColor(35, 0, 0, 255) );
  QCOMPARE( (*palette)[144], QColor(255, 253, 159, 255) );
  QCOMPARE( (*palette)[145], QColor(255, 252, 87, 255) );
  QCOMPARE( (*palette)[146], QColor(254, 251, 36, 255) );
  QCOMPARE( (*palette)[147], QColor(240, 236, 0, 255) );
  QCOMPARE( (*palette)[148], QColor(195, 195, 0, 255) );
  QCOMPARE( (*palette)[149], QColor(134, 134, 0, 255) );
  QCOMPARE( (*palette)[150], QColor(87, 85, 0, 255) );
  QCOMPARE( (*palette)[151], QColor(25, 25, 0, 255) );
  QCOMPARE( (*palette)[152], QColor(254, 190, 160, 255) );
  QCOMPARE( (*palette)[153], QColor(255, 140, 87, 255) );
  QCOMPARE( (*palette)[154], QColor(254, 105, 36, 255) );
  QCOMPARE( (*palette)[155], QColor(240, 76, 0, 255) );
  QCOMPARE( (*palette)[156], QColor(199, 65, 0, 255) );
  QCOMPARE( (*palette)[157], QColor(143, 46, 0, 255) );
  QCOMPARE( (*palette)[158], QColor(87, 26, 0, 255) );
  QCOMPARE( (*palette)[159], QColor(30, 7, 0, 255) );
  QCOMPARE( (*palette)[160], QColor(232, 202, 202, 255) );
  QCOMPARE( (*palette)[161], QColor(215, 178, 178, 255) );
  QCOMPARE( (*palette)[162], QColor(202, 158, 158, 255) );
  QCOMPARE( (*palette)[163], QColor(189, 143, 143, 255) );
  QCOMPARE( (*palette)[164], QColor(179, 128, 128, 255) );
  QCOMPARE( (*palette)[165], QColor(168, 113, 113, 255) );
  QCOMPARE( (*palette)[166], QColor(165, 90, 90, 255) );
  QCOMPARE( (*palette)[167], QColor(156, 73, 73, 255) );
  QCOMPARE( (*palette)[168], QColor(139, 65, 65, 255) );
  QCOMPARE( (*palette)[169], QColor(121, 57, 57, 255) );
  QCOMPARE( (*palette)[170], QColor(104, 49, 49, 255) );
  QCOMPARE( (*palette)[171], QColor(86, 41, 41, 255) );
  QCOMPARE( (*palette)[172], QColor(68, 33, 33, 255) );
  QCOMPARE( (*palette)[173], QColor(51, 25, 25, 255) );
  QCOMPARE( (*palette)[174], QColor(27, 14, 14, 255) );
  QCOMPARE( (*palette)[175], QColor(12, 7, 7, 255) );
  QCOMPARE( (*palette)[176], QColor(200, 205, 234, 255) );
  QCOMPARE( (*palette)[177], QColor(178, 183, 215, 255) );
  QCOMPARE( (*palette)[178], QColor(159, 165, 198, 255) );
  QCOMPARE( (*palette)[179], QColor(147, 153, 185, 255) );
  QCOMPARE( (*palette)[180], QColor(135, 141, 172, 255) );
  QCOMPARE( (*palette)[181], QColor(121, 127, 160, 255) );
  QCOMPARE( (*palette)[182], QColor(102, 112, 153, 255) );
  QCOMPARE( (*palette)[183], QColor(88, 99, 141, 255) );
  QCOMPARE( (*palette)[184], QColor(78, 88, 125, 255) );
  QCOMPARE( (*palette)[185], QColor(67, 76, 111, 255) );
  QCOMPARE( (*palette)[186], QColor(57, 65, 95, 255) );
  QCOMPARE( (*palette)[187], QColor(47, 54, 80, 255) );
  QCOMPARE( (*palette)[188], QColor(37, 43, 65, 255) );
  QCOMPARE( (*palette)[189], QColor(25, 30, 45, 255) );
  QCOMPARE( (*palette)[190], QColor(13, 17, 27, 255) );
  QCOMPARE( (*palette)[191], QColor(5, 7, 12, 255) );
  QCOMPARE( (*palette)[192], QColor(255, 227, 164, 255) );
  QCOMPARE( (*palette)[193], QColor(238, 209, 140, 255) );
  QCOMPARE( (*palette)[194], QColor(221, 196, 126, 255) );
  QCOMPARE( (*palette)[195], QColor(204, 183, 117, 255) );
  QCOMPARE( (*palette)[196], QColor(188, 168, 108, 255) );
  QCOMPARE( (*palette)[197], QColor(171, 154, 99, 255) );
  QCOMPARE( (*palette)[198], QColor(152, 139, 93, 255) );
  QCOMPARE( (*palette)[199], QColor(135, 126, 84, 255) );
  QCOMPARE( (*palette)[200], QColor(120, 111, 73, 255) );
  QCOMPARE( (*palette)[201], QColor(105, 96, 63, 255) );
  QCOMPARE( (*palette)[202], QColor(91, 81, 52, 255) );
  QCOMPARE( (*palette)[203], QColor(72, 64, 39, 255) );
  QCOMPARE( (*palette)[204], QColor(57, 49, 29, 255) );
  QCOMPARE( (*palette)[205], QColor(49, 40, 22, 255) );
  QCOMPARE( (*palette)[206], QColor(26, 20, 8, 255) );
  QCOMPARE( (*palette)[207], QColor(20, 11, 0, 255) );
  QCOMPARE( (*palette)[208], QColor(255, 226, 179, 255) );
  QCOMPARE( (*palette)[209], QColor(244, 201, 150, 255) );
  QCOMPARE( (*palette)[210], QColor(231, 179, 126, 255) );
  QCOMPARE( (*palette)[211], QColor(220, 159, 112, 255) );
  QCOMPARE( (*palette)[212], QColor(208, 140, 98, 255) );
  QCOMPARE( (*palette)[213], QColor(199, 123, 82, 255) );
  QCOMPARE( (*palette)[214], QColor(204, 97, 51, 255) );
  QCOMPARE( (*palette)[215], QColor(199, 75, 31, 255) );
  QCOMPARE( (*palette)[216], QColor(177, 67, 27, 255) );
  QCOMPARE( (*palette)[217], QColor(155, 59, 24, 255) );
  QCOMPARE( (*palette)[218], QColor(133, 50, 19, 255) );
  QCOMPARE( (*palette)[219], QColor(111, 41, 16, 255) );
  QCOMPARE( (*palette)[220], QColor(90, 34, 12, 255) );
  QCOMPARE( (*palette)[221], QColor(63, 23, 8, 255) );
  QCOMPARE( (*palette)[222], QColor(37, 14, 3, 255) );
  QCOMPARE( (*palette)[223], QColor(15, 5, 0, 255) );
  QCOMPARE( (*palette)[224], QColor(255, 189, 189, 255) );
  QCOMPARE( (*palette)[225], QColor(244, 150, 150, 255) );
  QCOMPARE( (*palette)[226], QColor(232, 125, 125, 255) );
  QCOMPARE( (*palette)[227], QColor(224, 108, 108, 255) );
  QCOMPARE( (*palette)[228], QColor(216, 91, 91, 255) );
  QCOMPARE( (*palette)[229], QColor(207, 73, 73, 255) );
  QCOMPARE( (*palette)[230], QColor(199, 56, 56, 255) );
  QCOMPARE( (*palette)[231], QColor(191, 39, 39, 255) );
  QCOMPARE( (*palette)[232], QColor(169, 34, 34, 255) );
  QCOMPARE( (*palette)[233], QColor(147, 30, 30, 255) );
  QCOMPARE( (*palette)[234], QColor(124, 25, 25, 255) );
  QCOMPARE( (*palette)[235], QColor(102, 21, 21, 255) );
  QCOMPARE( (*palette)[236], QColor(79, 17, 17, 255) );
  QCOMPARE( (*palette)[237], QColor(57, 13, 13, 255) );
  QCOMPARE( (*palette)[238], QColor(35, 9, 9, 255) );
  QCOMPARE( (*palette)[239], QColor(12, 5, 5, 255) );
  QCOMPARE( (*palette)[240], QColor(243, 243, 243, 255) );
  QCOMPARE( (*palette)[241], QColor(222, 222, 222, 255) );
  QCOMPARE( (*palette)[242], QColor(204, 204, 204, 255) );
  QCOMPARE( (*palette)[243], QColor(184, 184, 184, 255) );
  QCOMPARE( (*palette)[244], QColor(163, 163, 163, 255) );
  QCOMPARE( (*palette)[245], QColor(148, 148, 148, 255) );
  QCOMPARE( (*palette)[246], QColor(133, 133, 133, 255) );
  QCOMPARE( (*palette)[247], QColor(115, 115, 115, 255) );
  QCOMPARE( (*palette)[248], QColor(102, 102, 102, 255) );
  QCOMPARE( (*palette)[249], QColor(89, 89, 89, 255) );
  QCOMPARE( (*palette)[250], QColor(76, 76, 76, 255) );
  QCOMPARE( (*palette)[251], QColor(61, 61, 61, 255) );
  QCOMPARE( (*palette)[252], QColor(46, 46, 46, 255) );
  QCOMPARE( (*palette)[253], QColor(30, 30, 30, 255) );
  QCOMPARE( (*palette)[254], QColor(17, 17, 17, 255) );
  QCOMPARE( (*palette)[255], QColor(Qt::transparent) );

  // Advanced constructor
  QFile palette_file( "/levels/towndata/town.pal" );
  palette_file.open( QIODevice::ReadOnly );
  
  QByteArray palette_data( palette_file.size(), 0 );
  palette_file.read( palette_data.data(), palette_data.size() );
  
  palette.reset( new QtD1::CelPalette( "/levels/towndata/town.pal", palette_data ) );

  QCOMPARE( (*palette)[0], QColor(0, 0, 0, 255) );
  QCOMPARE( (*palette)[1], QColor(181, 93, 27, 255) );
  QCOMPARE( (*palette)[2], QColor(165, 93, 54, 255) );
  QCOMPARE( (*palette)[3], QColor(165, 85, 24, 255) );
  QCOMPARE( (*palette)[4], QColor(152, 86, 49, 255) );
  QCOMPARE( (*palette)[5], QColor(143, 86, 59, 255) );
  QCOMPARE( (*palette)[6], QColor(156, 84, 29, 255) );
  QCOMPARE( (*palette)[7], QColor(141, 88, 27, 255) );
  QCOMPARE( (*palette)[8], QColor(145, 82, 41, 255) );
  QCOMPARE( (*palette)[9], QColor(139, 82, 49, 255) );
  QCOMPARE( (*palette)[10], QColor(132, 73, 44, 255) );
  QCOMPARE( (*palette)[11], QColor(161, 62, 18, 255) );
  QCOMPARE( (*palette)[12], QColor(145, 66, 39, 255) );
  QCOMPARE( (*palette)[13], QColor(82, 83, 117, 255) );
  QCOMPARE( (*palette)[14], QColor(136, 70, 17, 255) );
  QCOMPARE( (*palette)[15], QColor(120, 69, 51, 255) );
  QCOMPARE( (*palette)[16], QColor(116, 74, 24, 255) );
  QCOMPARE( (*palette)[17], QColor(120, 66, 41, 255) );
  QCOMPARE( (*palette)[18], QColor(204, 24, 33, 255) );
  QCOMPARE( (*palette)[19], QColor(107, 74, 24, 255) );
  QCOMPARE( (*palette)[20], QColor(78, 74, 99, 255) );
  QCOMPARE( (*palette)[21], QColor(120, 64, 26, 255) );
  QCOMPARE( (*palette)[22], QColor(73, 71, 110, 255) );
  QCOMPARE( (*palette)[23], QColor(206, 16, 32, 255) );
  QCOMPARE( (*palette)[24], QColor(107, 66, 24, 255) );
  QCOMPARE( (*palette)[25], QColor(198, 16, 33, 255) );
  QCOMPARE( (*palette)[26], QColor(78, 66, 92, 255) );
  QCOMPARE( (*palette)[27], QColor(198, 16, 24, 255) );
  QCOMPARE( (*palette)[28], QColor(99, 66, 24, 255) );
  QCOMPARE( (*palette)[29], QColor(101, 61, 44, 255) );
  QCOMPARE( (*palette)[30], QColor(83, 63, 75, 255) );
  QCOMPARE( (*palette)[31], QColor(65, 67, 94, 255) );
  QCOMPARE( (*palette)[32], QColor(189, 16, 24, 255) );
  QCOMPARE( (*palette)[33], QColor(101, 62, 16, 255) );
  QCOMPARE( (*palette)[34], QColor(103, 56, 30, 255) );
  QCOMPARE( (*palette)[35], QColor(181, 16, 24, 255) );
  QCOMPARE( (*palette)[36], QColor(181, 16, 16, 255) );
  QCOMPARE( (*palette)[37], QColor(173, 16, 24, 255) );
  QCOMPARE( (*palette)[38], QColor(173, 16, 16, 255) );
  QCOMPARE( (*palette)[39], QColor(165, 16, 24, 255) );
  QCOMPARE( (*palette)[40], QColor(62, 58, 78, 255) );
  QCOMPARE( (*palette)[41], QColor(165, 16, 16, 255) );
  QCOMPARE( (*palette)[42], QColor(156, 16, 24, 255) );
  QCOMPARE( (*palette)[43], QColor(54, 54, 93, 255) );
  QCOMPARE( (*palette)[44], QColor(156, 16, 16, 255) );
  QCOMPARE( (*palette)[45], QColor(78, 50, 28, 255) );
  QCOMPARE( (*palette)[46], QColor(165, 8, 16, 255) );
  QCOMPARE( (*palette)[47], QColor(67, 52, 46, 255) );
  QCOMPARE( (*palette)[48], QColor(61, 48, 64, 255) );
  QCOMPARE( (*palette)[49], QColor(81, 41, 45, 255) );
  QCOMPARE( (*palette)[50], QColor(156, 8, 16, 255) );
  QCOMPARE( (*palette)[51], QColor(145, 12, 17, 255) );
  QCOMPARE( (*palette)[52], QColor(47, 50, 73, 255) );
  QCOMPARE( (*palette)[53], QColor(73, 46, 16, 255) );
  QCOMPARE( (*palette)[54], QColor(46, 49, 44, 255) );
  QCOMPARE( (*palette)[55], QColor(129, 12, 16, 255) );
  QCOMPARE( (*palette)[56], QColor(47, 49, 33, 255) );
  QCOMPARE( (*palette)[57], QColor(57, 41, 45, 255) );
  QCOMPARE( (*palette)[58], QColor(105, 19, 20, 255) );
  QCOMPARE( (*palette)[59], QColor(43, 41, 71, 255) );
  QCOMPARE( (*palette)[60], QColor(49, 41, 41, 255) );
  QCOMPARE( (*palette)[61], QColor(45, 41, 49, 255) );
  QCOMPARE( (*palette)[62], QColor(43, 40, 57, 255) );
  QCOMPARE( (*palette)[63], QColor(52, 41, 20, 255) );
  QCOMPARE( (*palette)[64], QColor(120, 8, 8, 255) );
  QCOMPARE( (*palette)[65], QColor(59, 32, 42, 255) );
  QCOMPARE( (*palette)[66], QColor(44, 41, 33, 255) );
  QCOMPARE( (*palette)[67], QColor(41, 41, 41, 255) );
  QCOMPARE( (*palette)[68], QColor(68, 26, 26, 255) );
  QCOMPARE( (*palette)[69], QColor(33, 41, 41, 255) );
  QCOMPARE( (*palette)[70], QColor(49, 33, 33, 255) );
  QCOMPARE( (*palette)[71], QColor(33, 41, 33, 255) );
  QCOMPARE( (*palette)[72], QColor(107, 8, 8, 255) );
  QCOMPARE( (*palette)[73], QColor(41, 33, 49, 255) );
  QCOMPARE( (*palette)[74], QColor(33, 41, 24, 255) );
  QCOMPARE( (*palette)[75], QColor(27, 35, 70, 255) );
  QCOMPARE( (*palette)[76], QColor(41, 33, 41, 255) );
  QCOMPARE( (*palette)[77], QColor(41, 33, 33, 255) );
  QCOMPARE( (*palette)[78], QColor(44, 33, 24, 255) );
  QCOMPARE( (*palette)[79], QColor(99, 8, 8, 255) );
  QCOMPARE( (*palette)[80], QColor(46, 33, 12, 255) );
  QCOMPARE( (*palette)[81], QColor(32, 33, 49, 255) );
  QCOMPARE( (*palette)[82], QColor(33, 33, 41, 255) );
  QCOMPARE( (*palette)[83], QColor(33, 33, 33, 255) );
  QCOMPARE( (*palette)[84], QColor(87, 10, 8, 255) );
  QCOMPARE( (*palette)[85], QColor(33, 33, 24, 255) );
  QCOMPARE( (*palette)[86], QColor(24, 33, 41, 255) );
  QCOMPARE( (*palette)[87], QColor(33, 33, 16, 255) );
  QCOMPARE( (*palette)[88], QColor(41, 24, 42, 255) );
  QCOMPARE( (*palette)[89], QColor(44, 24, 33, 255) );
  QCOMPARE( (*palette)[90], QColor(24, 33, 33, 255) );
  QCOMPARE( (*palette)[91], QColor(25, 28, 57, 255) );
  QCOMPARE( (*palette)[92], QColor(33, 33, 8, 255) );
  QCOMPARE( (*palette)[93], QColor(24, 33, 24, 255) );
  QCOMPARE( (*palette)[94], QColor(24, 33, 14, 255) );
  QCOMPARE( (*palette)[95], QColor(33, 24, 33, 255) );
  QCOMPARE( (*palette)[96], QColor(43, 21, 18, 255) );
  QCOMPARE( (*palette)[97], QColor(33, 24, 24, 255) );
  QCOMPARE( (*palette)[98], QColor(33, 24, 16, 255) );
  QCOMPARE( (*palette)[99], QColor(19, 24, 49, 255) );
  QCOMPARE( (*palette)[100], QColor(24, 24, 33, 255) );
  QCOMPARE( (*palette)[101], QColor(25, 22, 41, 255) );
  QCOMPARE( (*palette)[102], QColor(24, 24, 24, 255) );
  QCOMPARE( (*palette)[103], QColor(24, 24, 16, 255) );
  QCOMPARE( (*palette)[104], QColor(16, 24, 24, 255) );
  QCOMPARE( (*palette)[105], QColor(16, 24, 16, 255) );
  QCOMPARE( (*palette)[106], QColor(24, 16, 33, 255) );
  QCOMPARE( (*palette)[107], QColor(67, 0, 1, 255) );
  QCOMPARE( (*palette)[108], QColor(28, 18, 6, 255) );
  QCOMPARE( (*palette)[109], QColor(25, 16, 24, 255) );
  QCOMPARE( (*palette)[110], QColor(15, 18, 33, 255) );
  QCOMPARE( (*palette)[111], QColor(25, 16, 16, 255) );
  QCOMPARE( (*palette)[112], QColor(16, 16, 24, 255) );
  QCOMPARE( (*palette)[113], QColor(16, 16, 16, 255) );
  QCOMPARE( (*palette)[114], QColor(16, 16, 8, 255) );
  QCOMPARE( (*palette)[115], QColor(8, 16, 16, 255) );
  QCOMPARE( (*palette)[116], QColor(8, 16, 8, 255) );
  QCOMPARE( (*palette)[117], QColor(16, 8, 24, 255) );
  QCOMPARE( (*palette)[118], QColor(17, 8, 16, 255) );
  QCOMPARE( (*palette)[119], QColor(8, 11, 24, 255) );
  QCOMPARE( (*palette)[120], QColor(17, 8, 7, 255) );
  QCOMPARE( (*palette)[121], QColor(8, 8, 16, 255) );
  QCOMPARE( (*palette)[122], QColor(8, 8, 8, 255) );
  QCOMPARE( (*palette)[123], QColor(8, 8, 0, 255) );
  QCOMPARE( (*palette)[124], QColor(0, 8, 8, 255) );
  QCOMPARE( (*palette)[125], QColor(8, 0, 0, 255) );
  QCOMPARE( (*palette)[126], QColor(4, 0, 8, 255) );
  QCOMPARE( (*palette)[127], QColor(0, 0, 0, 255) );
  QCOMPARE( (*palette)[128], QColor(159, 159, 255, 255) );
  QCOMPARE( (*palette)[129], QColor(87, 87, 255, 255) );
  QCOMPARE( (*palette)[130], QColor(36, 36, 254, 255) );
  QCOMPARE( (*palette)[131], QColor(1, 1, 239, 255) );
  QCOMPARE( (*palette)[132], QColor(0, 0, 189, 255) );
  QCOMPARE( (*palette)[133], QColor(0, 0, 138, 255) );
  QCOMPARE( (*palette)[134], QColor(0, 0, 87, 255) );
  QCOMPARE( (*palette)[135], QColor(0, 0, 25, 255) );
  QCOMPARE( (*palette)[136], QColor(255, 159, 159, 255) );
  QCOMPARE( (*palette)[137], QColor(255, 87, 87, 255) );
  QCOMPARE( (*palette)[138], QColor(254, 36, 36, 255) );
  QCOMPARE( (*palette)[139], QColor(240, 0, 0, 255) );
  QCOMPARE( (*palette)[140], QColor(189, 0, 0, 255) );
  QCOMPARE( (*palette)[141], QColor(145, 0, 0, 255) );
  QCOMPARE( (*palette)[142], QColor(90, 0, 0, 255) );
  QCOMPARE( (*palette)[143], QColor(35, 0, 0, 255) );
  QCOMPARE( (*palette)[144], QColor(255, 253, 159, 255) );
  QCOMPARE( (*palette)[145], QColor(255, 252, 87, 255) );
  QCOMPARE( (*palette)[146], QColor(254, 251, 36, 255) );
  QCOMPARE( (*palette)[147], QColor(240, 236, 0, 255) );
  QCOMPARE( (*palette)[148], QColor(195, 195, 0, 255) );
  QCOMPARE( (*palette)[149], QColor(134, 134, 0, 255) );
  QCOMPARE( (*palette)[150], QColor(87, 85, 0, 255) );
  QCOMPARE( (*palette)[151], QColor(25, 25, 0, 255) );
  QCOMPARE( (*palette)[152], QColor(254, 190, 160, 255) );
  QCOMPARE( (*palette)[153], QColor(255, 140, 87, 255) );
  QCOMPARE( (*palette)[154], QColor(254, 105, 36, 255) );
  QCOMPARE( (*palette)[155], QColor(240, 76, 0, 255) );
  QCOMPARE( (*palette)[156], QColor(199, 65, 0, 255) );
  QCOMPARE( (*palette)[157], QColor(143, 46, 0, 255) );
  QCOMPARE( (*palette)[158], QColor(87, 26, 0, 255) );
  QCOMPARE( (*palette)[159], QColor(30, 7, 0, 255) );
  QCOMPARE( (*palette)[160], QColor(232, 202, 202, 255) );
  QCOMPARE( (*palette)[161], QColor(215, 178, 178, 255) );
  QCOMPARE( (*palette)[162], QColor(202, 158, 158, 255) );
  QCOMPARE( (*palette)[163], QColor(189, 143, 143, 255) );
  QCOMPARE( (*palette)[164], QColor(179, 128, 128, 255) );
  QCOMPARE( (*palette)[165], QColor(168, 113, 113, 255) );
  QCOMPARE( (*palette)[166], QColor(165, 90, 90, 255) );
  QCOMPARE( (*palette)[167], QColor(156, 73, 73, 255) );
  QCOMPARE( (*palette)[168], QColor(139, 65, 65, 255) );
  QCOMPARE( (*palette)[169], QColor(121, 57, 57, 255) );
  QCOMPARE( (*palette)[170], QColor(104, 49, 49, 255) );
  QCOMPARE( (*palette)[171], QColor(86, 41, 41, 255) );
  QCOMPARE( (*palette)[172], QColor(68, 33, 33, 255) );
  QCOMPARE( (*palette)[173], QColor(51, 25, 25, 255) );
  QCOMPARE( (*palette)[174], QColor(27, 14, 14, 255) );
  QCOMPARE( (*palette)[175], QColor(12, 7, 7, 255) );
  QCOMPARE( (*palette)[176], QColor(200, 205, 234, 255) );
  QCOMPARE( (*palette)[177], QColor(178, 183, 215, 255) );
  QCOMPARE( (*palette)[178], QColor(159, 165, 198, 255) );
  QCOMPARE( (*palette)[179], QColor(147, 153, 185, 255) );
  QCOMPARE( (*palette)[180], QColor(135, 141, 172, 255) );
  QCOMPARE( (*palette)[181], QColor(121, 127, 160, 255) );
  QCOMPARE( (*palette)[182], QColor(102, 112, 153, 255) );
  QCOMPARE( (*palette)[183], QColor(88, 99, 141, 255) );
  QCOMPARE( (*palette)[184], QColor(78, 88, 125, 255) );
  QCOMPARE( (*palette)[185], QColor(67, 76, 111, 255) );
  QCOMPARE( (*palette)[186], QColor(57, 65, 95, 255) );
  QCOMPARE( (*palette)[187], QColor(47, 54, 80, 255) );
  QCOMPARE( (*palette)[188], QColor(37, 43, 65, 255) );
  QCOMPARE( (*palette)[189], QColor(25, 30, 45, 255) );
  QCOMPARE( (*palette)[190], QColor(13, 17, 27, 255) );
  QCOMPARE( (*palette)[191], QColor(5, 7, 12, 255) );
  QCOMPARE( (*palette)[192], QColor(255, 227, 164, 255) );
  QCOMPARE( (*palette)[193], QColor(238, 209, 140, 255) );
  QCOMPARE( (*palette)[194], QColor(221, 196, 126, 255) );
  QCOMPARE( (*palette)[195], QColor(204, 183, 117, 255) );
  QCOMPARE( (*palette)[196], QColor(188, 168, 108, 255) );
  QCOMPARE( (*palette)[197], QColor(171, 154, 99, 255) );
  QCOMPARE( (*palette)[198], QColor(152, 139, 93, 255) );
  QCOMPARE( (*palette)[199], QColor(135, 126, 84, 255) );
  QCOMPARE( (*palette)[200], QColor(120, 111, 73, 255) );
  QCOMPARE( (*palette)[201], QColor(105, 96, 63, 255) );
  QCOMPARE( (*palette)[202], QColor(91, 81, 52, 255) );
  QCOMPARE( (*palette)[203], QColor(72, 64, 39, 255) );
  QCOMPARE( (*palette)[204], QColor(57, 49, 29, 255) );
  QCOMPARE( (*palette)[205], QColor(49, 40, 22, 255) );
  QCOMPARE( (*palette)[206], QColor(26, 20, 8, 255) );
  QCOMPARE( (*palette)[207], QColor(20, 11, 0, 255) );
  QCOMPARE( (*palette)[208], QColor(255, 226, 179, 255) );
  QCOMPARE( (*palette)[209], QColor(244, 201, 150, 255) );
  QCOMPARE( (*palette)[210], QColor(231, 179, 126, 255) );
  QCOMPARE( (*palette)[211], QColor(220, 159, 112, 255) );
  QCOMPARE( (*palette)[212], QColor(208, 140, 98, 255) );
  QCOMPARE( (*palette)[213], QColor(199, 123, 82, 255) );
  QCOMPARE( (*palette)[214], QColor(204, 97, 51, 255) );
  QCOMPARE( (*palette)[215], QColor(199, 75, 31, 255) );
  QCOMPARE( (*palette)[216], QColor(177, 67, 27, 255) );
  QCOMPARE( (*palette)[217], QColor(155, 59, 24, 255) );
  QCOMPARE( (*palette)[218], QColor(133, 50, 19, 255) );
  QCOMPARE( (*palette)[219], QColor(111, 41, 16, 255) );
  QCOMPARE( (*palette)[220], QColor(90, 34, 12, 255) );
  QCOMPARE( (*palette)[221], QColor(63, 23, 8, 255) );
  QCOMPARE( (*palette)[222], QColor(37, 14, 3, 255) );
  QCOMPARE( (*palette)[223], QColor(15, 5, 0, 255) );
  QCOMPARE( (*palette)[224], QColor(255, 189, 189, 255) );
  QCOMPARE( (*palette)[225], QColor(244, 150, 150, 255) );
  QCOMPARE( (*palette)[226], QColor(232, 125, 125, 255) );
  QCOMPARE( (*palette)[227], QColor(224, 108, 108, 255) );
  QCOMPARE( (*palette)[228], QColor(216, 91, 91, 255) );
  QCOMPARE( (*palette)[229], QColor(207, 73, 73, 255) );
  QCOMPARE( (*palette)[230], QColor(199, 56, 56, 255) );
  QCOMPARE( (*palette)[231], QColor(191, 39, 39, 255) );
  QCOMPARE( (*palette)[232], QColor(169, 34, 34, 255) );
  QCOMPARE( (*palette)[233], QColor(147, 30, 30, 255) );
  QCOMPARE( (*palette)[234], QColor(124, 25, 25, 255) );
  QCOMPARE( (*palette)[235], QColor(102, 21, 21, 255) );
  QCOMPARE( (*palette)[236], QColor(79, 17, 17, 255) );
  QCOMPARE( (*palette)[237], QColor(57, 13, 13, 255) );
  QCOMPARE( (*palette)[238], QColor(35, 9, 9, 255) );
  QCOMPARE( (*palette)[239], QColor(12, 5, 5, 255) );
  QCOMPARE( (*palette)[240], QColor(243, 243, 243, 255) );
  QCOMPARE( (*palette)[241], QColor(222, 222, 222, 255) );
  QCOMPARE( (*palette)[242], QColor(204, 204, 204, 255) );
  QCOMPARE( (*palette)[243], QColor(184, 184, 184, 255) );
  QCOMPARE( (*palette)[244], QColor(163, 163, 163, 255) );
  QCOMPARE( (*palette)[245], QColor(148, 148, 148, 255) );
  QCOMPARE( (*palette)[246], QColor(133, 133, 133, 255) );
  QCOMPARE( (*palette)[247], QColor(115, 115, 115, 255) );
  QCOMPARE( (*palette)[248], QColor(102, 102, 102, 255) );
  QCOMPARE( (*palette)[249], QColor(89, 89, 89, 255) );
  QCOMPARE( (*palette)[250], QColor(76, 76, 76, 255) );
  QCOMPARE( (*palette)[251], QColor(61, 61, 61, 255) );
  QCOMPARE( (*palette)[252], QColor(46, 46, 46, 255) );
  QCOMPARE( (*palette)[253], QColor(30, 30, 30, 255) );
  QCOMPARE( (*palette)[254], QColor(17, 17, 17, 255) );
  QCOMPARE( (*palette)[255], QColor(Qt::transparent) );
}

//---------------------------------------------------------------------------//
// Check that the QRgb corresponding to a color key can be returned
void getRgba()
{
  std::unique_ptr<QtD1::CelPalette>
    palette( new QtD1::CelPalette("/levels/towndata/town.pal") );

  QCOMPARE( palette->getRgba( 0 ), QColor(0, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 1 ), QColor(181, 93, 27, 255).rgba() );
  QCOMPARE( palette->getRgba( 2 ), QColor(165, 93, 54, 255).rgba() );
  QCOMPARE( palette->getRgba( 3 ), QColor(165, 85, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 4 ), QColor(152, 86, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 5 ), QColor(143, 86, 59, 255).rgba() );
  QCOMPARE( palette->getRgba( 6 ), QColor(156, 84, 29, 255).rgba() );
  QCOMPARE( palette->getRgba( 7 ), QColor(141, 88, 27, 255).rgba() );
  QCOMPARE( palette->getRgba( 8 ), QColor(145, 82, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 9 ), QColor(139, 82, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 10 ), QColor(132, 73, 44, 255).rgba() );
  QCOMPARE( palette->getRgba( 11 ), QColor(161, 62, 18, 255).rgba() );
  QCOMPARE( palette->getRgba( 12 ), QColor(145, 66, 39, 255).rgba() );
  QCOMPARE( palette->getRgba( 13 ), QColor(82, 83, 117, 255).rgba() );
  QCOMPARE( palette->getRgba( 14 ), QColor(136, 70, 17, 255).rgba() );
  QCOMPARE( palette->getRgba( 15 ), QColor(120, 69, 51, 255).rgba() );
  QCOMPARE( palette->getRgba( 16 ), QColor(116, 74, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 17 ), QColor(120, 66, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 18 ), QColor(204, 24, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 19 ), QColor(107, 74, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 20 ), QColor(78, 74, 99, 255).rgba() );
  QCOMPARE( palette->getRgba( 21 ), QColor(120, 64, 26, 255).rgba() );
  QCOMPARE( palette->getRgba( 22 ), QColor(73, 71, 110, 255).rgba() );
  QCOMPARE( palette->getRgba( 23 ), QColor(206, 16, 32, 255).rgba() );
  QCOMPARE( palette->getRgba( 24 ), QColor(107, 66, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 25 ), QColor(198, 16, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 26 ), QColor(78, 66, 92, 255).rgba() );
  QCOMPARE( palette->getRgba( 27 ), QColor(198, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 28 ), QColor(99, 66, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 29 ), QColor(101, 61, 44, 255).rgba() );
  QCOMPARE( palette->getRgba( 30 ), QColor(83, 63, 75, 255).rgba() );
  QCOMPARE( palette->getRgba( 31 ), QColor(65, 67, 94, 255).rgba() );
  QCOMPARE( palette->getRgba( 32 ), QColor(189, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 33 ), QColor(101, 62, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 34 ), QColor(103, 56, 30, 255).rgba() );
  QCOMPARE( palette->getRgba( 35 ), QColor(181, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 36 ), QColor(181, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 37 ), QColor(173, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 38 ), QColor(173, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 39 ), QColor(165, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 40 ), QColor(62, 58, 78, 255).rgba() );
  QCOMPARE( palette->getRgba( 41 ), QColor(165, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 42 ), QColor(156, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 43 ), QColor(54, 54, 93, 255).rgba() );
  QCOMPARE( palette->getRgba( 44 ), QColor(156, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 45 ), QColor(78, 50, 28, 255).rgba() );
  QCOMPARE( palette->getRgba( 46 ), QColor(165, 8, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 47 ), QColor(67, 52, 46, 255).rgba() );
  QCOMPARE( palette->getRgba( 48 ), QColor(61, 48, 64, 255).rgba() );
  QCOMPARE( palette->getRgba( 49 ), QColor(81, 41, 45, 255).rgba() );
  QCOMPARE( palette->getRgba( 50 ), QColor(156, 8, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 51 ), QColor(145, 12, 17, 255).rgba() );
  QCOMPARE( palette->getRgba( 52 ), QColor(47, 50, 73, 255).rgba() );
  QCOMPARE( palette->getRgba( 53 ), QColor(73, 46, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 54 ), QColor(46, 49, 44, 255).rgba() );
  QCOMPARE( palette->getRgba( 55 ), QColor(129, 12, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 56 ), QColor(47, 49, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 57 ), QColor(57, 41, 45, 255).rgba() );
  QCOMPARE( palette->getRgba( 58 ), QColor(105, 19, 20, 255).rgba() );
  QCOMPARE( palette->getRgba( 59 ), QColor(43, 41, 71, 255).rgba() );
  QCOMPARE( palette->getRgba( 60 ), QColor(49, 41, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 61 ), QColor(45, 41, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 62 ), QColor(43, 40, 57, 255).rgba() );
  QCOMPARE( palette->getRgba( 63 ), QColor(52, 41, 20, 255).rgba() );
  QCOMPARE( palette->getRgba( 64 ), QColor(120, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 65 ), QColor(59, 32, 42, 255).rgba() );
  QCOMPARE( palette->getRgba( 66 ), QColor(44, 41, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 67 ), QColor(41, 41, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 68 ), QColor(68, 26, 26, 255).rgba() );
  QCOMPARE( palette->getRgba( 69 ), QColor(33, 41, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 70 ), QColor(49, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 71 ), QColor(33, 41, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 72 ), QColor(107, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 73 ), QColor(41, 33, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 74 ), QColor(33, 41, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 75 ), QColor(27, 35, 70, 255).rgba() );
  QCOMPARE( palette->getRgba( 76 ), QColor(41, 33, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 77 ), QColor(41, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 78 ), QColor(44, 33, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 79 ), QColor(99, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 80 ), QColor(46, 33, 12, 255).rgba() );
  QCOMPARE( palette->getRgba( 81 ), QColor(32, 33, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 82 ), QColor(33, 33, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 83 ), QColor(33, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 84 ), QColor(87, 10, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 85 ), QColor(33, 33, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 86 ), QColor(24, 33, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 87 ), QColor(33, 33, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 88 ), QColor(41, 24, 42, 255).rgba() );
  QCOMPARE( palette->getRgba( 89 ), QColor(44, 24, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 90 ), QColor(24, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 91 ), QColor(25, 28, 57, 255).rgba() );
  QCOMPARE( palette->getRgba( 92 ), QColor(33, 33, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 93 ), QColor(24, 33, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 94 ), QColor(24, 33, 14, 255).rgba() );
  QCOMPARE( palette->getRgba( 95 ), QColor(33, 24, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 96 ), QColor(43, 21, 18, 255).rgba() );
  QCOMPARE( palette->getRgba( 97 ), QColor(33, 24, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 98 ), QColor(33, 24, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 99 ), QColor(19, 24, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 100 ), QColor(24, 24, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 101 ), QColor(25, 22, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 102 ), QColor(24, 24, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 103 ), QColor(24, 24, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 104 ), QColor(16, 24, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 105 ), QColor(16, 24, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 106 ), QColor(24, 16, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 107 ), QColor(67, 0, 1, 255).rgba() );
  QCOMPARE( palette->getRgba( 108 ), QColor(28, 18, 6, 255).rgba() );
  QCOMPARE( palette->getRgba( 109 ), QColor(25, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 110 ), QColor(15, 18, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 111 ), QColor(25, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 112 ), QColor(16, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 113 ), QColor(16, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 114 ), QColor(16, 16, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 115 ), QColor(8, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 116 ), QColor(8, 16, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 117 ), QColor(16, 8, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 118 ), QColor(17, 8, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 119 ), QColor(8, 11, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 120 ), QColor(17, 8, 7, 255).rgba() );
  QCOMPARE( palette->getRgba( 121 ), QColor(8, 8, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 122 ), QColor(8, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 123 ), QColor(8, 8, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 124 ), QColor(0, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 125 ), QColor(8, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 126 ), QColor(4, 0, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 127 ), QColor(0, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 128 ), QColor(159, 159, 255, 255).rgba() );
  QCOMPARE( palette->getRgba( 129 ), QColor(87, 87, 255, 255).rgba() );
  QCOMPARE( palette->getRgba( 130 ), QColor(36, 36, 254, 255).rgba() );
  QCOMPARE( palette->getRgba( 131 ), QColor(1, 1, 239, 255).rgba() );
  QCOMPARE( palette->getRgba( 132 ), QColor(0, 0, 189, 255).rgba() );
  QCOMPARE( palette->getRgba( 133 ), QColor(0, 0, 138, 255).rgba() );
  QCOMPARE( palette->getRgba( 134 ), QColor(0, 0, 87, 255).rgba() );
  QCOMPARE( palette->getRgba( 135 ), QColor(0, 0, 25, 255).rgba() );
  QCOMPARE( palette->getRgba( 136 ), QColor(255, 159, 159, 255).rgba() );
  QCOMPARE( palette->getRgba( 137 ), QColor(255, 87, 87, 255).rgba() );
  QCOMPARE( palette->getRgba( 138 ), QColor(254, 36, 36, 255).rgba() );
  QCOMPARE( palette->getRgba( 139 ), QColor(240, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 140 ), QColor(189, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 141 ), QColor(145, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 142 ), QColor(90, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 143 ), QColor(35, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 144 ), QColor(255, 253, 159, 255).rgba() );
  QCOMPARE( palette->getRgba( 145 ), QColor(255, 252, 87, 255).rgba() );
  QCOMPARE( palette->getRgba( 146 ), QColor(254, 251, 36, 255).rgba() );
  QCOMPARE( palette->getRgba( 147 ), QColor(240, 236, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 148 ), QColor(195, 195, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 149 ), QColor(134, 134, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 150 ), QColor(87, 85, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 151 ), QColor(25, 25, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 152 ), QColor(254, 190, 160, 255).rgba() );
  QCOMPARE( palette->getRgba( 153 ), QColor(255, 140, 87, 255).rgba() );
  QCOMPARE( palette->getRgba( 154 ), QColor(254, 105, 36, 255).rgba() );
  QCOMPARE( palette->getRgba( 155 ), QColor(240, 76, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 156 ), QColor(199, 65, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 157 ), QColor(143, 46, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 158 ), QColor(87, 26, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 159 ), QColor(30, 7, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 160 ), QColor(232, 202, 202, 255).rgba() );
  QCOMPARE( palette->getRgba( 161 ), QColor(215, 178, 178, 255).rgba() );
  QCOMPARE( palette->getRgba( 162 ), QColor(202, 158, 158, 255).rgba() );
  QCOMPARE( palette->getRgba( 163 ), QColor(189, 143, 143, 255).rgba() );
  QCOMPARE( palette->getRgba( 164 ), QColor(179, 128, 128, 255).rgba() );
  QCOMPARE( palette->getRgba( 165 ), QColor(168, 113, 113, 255).rgba() );
  QCOMPARE( palette->getRgba( 166 ), QColor(165, 90, 90, 255).rgba() );
  QCOMPARE( palette->getRgba( 167 ), QColor(156, 73, 73, 255).rgba() );
  QCOMPARE( palette->getRgba( 168 ), QColor(139, 65, 65, 255).rgba() );
  QCOMPARE( palette->getRgba( 169 ), QColor(121, 57, 57, 255).rgba() );
  QCOMPARE( palette->getRgba( 170 ), QColor(104, 49, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 171 ), QColor(86, 41, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 172 ), QColor(68, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 173 ), QColor(51, 25, 25, 255).rgba() );
  QCOMPARE( palette->getRgba( 174 ), QColor(27, 14, 14, 255).rgba() );
  QCOMPARE( palette->getRgba( 175 ), QColor(12, 7, 7, 255).rgba() );
  QCOMPARE( palette->getRgba( 176 ), QColor(200, 205, 234, 255).rgba() );
  QCOMPARE( palette->getRgba( 177 ), QColor(178, 183, 215, 255).rgba() );
  QCOMPARE( palette->getRgba( 178 ), QColor(159, 165, 198, 255).rgba() );
  QCOMPARE( palette->getRgba( 179 ), QColor(147, 153, 185, 255).rgba() );
  QCOMPARE( palette->getRgba( 180 ), QColor(135, 141, 172, 255).rgba() );
  QCOMPARE( palette->getRgba( 181 ), QColor(121, 127, 160, 255).rgba() );
  QCOMPARE( palette->getRgba( 182 ), QColor(102, 112, 153, 255).rgba() );
  QCOMPARE( palette->getRgba( 183 ), QColor(88, 99, 141, 255).rgba() );
  QCOMPARE( palette->getRgba( 184 ), QColor(78, 88, 125, 255).rgba() );
  QCOMPARE( palette->getRgba( 185 ), QColor(67, 76, 111, 255).rgba() );
  QCOMPARE( palette->getRgba( 186 ), QColor(57, 65, 95, 255).rgba() );
  QCOMPARE( palette->getRgba( 187 ), QColor(47, 54, 80, 255).rgba() );
  QCOMPARE( palette->getRgba( 188 ), QColor(37, 43, 65, 255).rgba() );
  QCOMPARE( palette->getRgba( 189 ), QColor(25, 30, 45, 255).rgba() );
  QCOMPARE( palette->getRgba( 190 ), QColor(13, 17, 27, 255).rgba() );
  QCOMPARE( palette->getRgba( 191 ), QColor(5, 7, 12, 255).rgba() );
  QCOMPARE( palette->getRgba( 192 ), QColor(255, 227, 164, 255).rgba() );
  QCOMPARE( palette->getRgba( 193 ), QColor(238, 209, 140, 255).rgba() );
  QCOMPARE( palette->getRgba( 194 ), QColor(221, 196, 126, 255).rgba() );
  QCOMPARE( palette->getRgba( 195 ), QColor(204, 183, 117, 255).rgba() );
  QCOMPARE( palette->getRgba( 196 ), QColor(188, 168, 108, 255).rgba() );
  QCOMPARE( palette->getRgba( 197 ), QColor(171, 154, 99, 255).rgba() );
  QCOMPARE( palette->getRgba( 198 ), QColor(152, 139, 93, 255).rgba() );
  QCOMPARE( palette->getRgba( 199 ), QColor(135, 126, 84, 255).rgba() );
  QCOMPARE( palette->getRgba( 200 ), QColor(120, 111, 73, 255).rgba() );
  QCOMPARE( palette->getRgba( 201 ), QColor(105, 96, 63, 255).rgba() );
  QCOMPARE( palette->getRgba( 202 ), QColor(91, 81, 52, 255).rgba() );
  QCOMPARE( palette->getRgba( 203 ), QColor(72, 64, 39, 255).rgba() );
  QCOMPARE( palette->getRgba( 204 ), QColor(57, 49, 29, 255).rgba() );
  QCOMPARE( palette->getRgba( 205 ), QColor(49, 40, 22, 255).rgba() );
  QCOMPARE( palette->getRgba( 206 ), QColor(26, 20, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 207 ), QColor(20, 11, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 208 ), QColor(255, 226, 179, 255).rgba() );
  QCOMPARE( palette->getRgba( 209 ), QColor(244, 201, 150, 255).rgba() );
  QCOMPARE( palette->getRgba( 210 ), QColor(231, 179, 126, 255).rgba() );
  QCOMPARE( palette->getRgba( 211 ), QColor(220, 159, 112, 255).rgba() );
  QCOMPARE( palette->getRgba( 212 ), QColor(208, 140, 98, 255).rgba() );
  QCOMPARE( palette->getRgba( 213 ), QColor(199, 123, 82, 255).rgba() );
  QCOMPARE( palette->getRgba( 214 ), QColor(204, 97, 51, 255).rgba() );
  QCOMPARE( palette->getRgba( 215 ), QColor(199, 75, 31, 255).rgba() );
  QCOMPARE( palette->getRgba( 216 ), QColor(177, 67, 27, 255).rgba() );
  QCOMPARE( palette->getRgba( 217 ), QColor(155, 59, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 218 ), QColor(133, 50, 19, 255).rgba() );
  QCOMPARE( palette->getRgba( 219 ), QColor(111, 41, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 220 ), QColor(90, 34, 12, 255).rgba() );
  QCOMPARE( palette->getRgba( 221 ), QColor(63, 23, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 222 ), QColor(37, 14, 3, 255).rgba() );
  QCOMPARE( palette->getRgba( 223 ), QColor(15, 5, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 224 ), QColor(255, 189, 189, 255).rgba() );
  QCOMPARE( palette->getRgba( 225 ), QColor(244, 150, 150, 255).rgba() );
  QCOMPARE( palette->getRgba( 226 ), QColor(232, 125, 125, 255).rgba() );
  QCOMPARE( palette->getRgba( 227 ), QColor(224, 108, 108, 255).rgba() );
  QCOMPARE( palette->getRgba( 228 ), QColor(216, 91, 91, 255).rgba() );
  QCOMPARE( palette->getRgba( 229 ), QColor(207, 73, 73, 255).rgba() );
  QCOMPARE( palette->getRgba( 230 ), QColor(199, 56, 56, 255).rgba() );
  QCOMPARE( palette->getRgba( 231 ), QColor(191, 39, 39, 255).rgba() );
  QCOMPARE( palette->getRgba( 232 ), QColor(169, 34, 34, 255).rgba() );
  QCOMPARE( palette->getRgba( 233 ), QColor(147, 30, 30, 255).rgba() );
  QCOMPARE( palette->getRgba( 234 ), QColor(124, 25, 25, 255).rgba() );
  QCOMPARE( palette->getRgba( 235 ), QColor(102, 21, 21, 255).rgba() );
  QCOMPARE( palette->getRgba( 236 ), QColor(79, 17, 17, 255).rgba() );
  QCOMPARE( palette->getRgba( 237 ), QColor(57, 13, 13, 255).rgba() );
  QCOMPARE( palette->getRgba( 238 ), QColor(35, 9, 9, 255).rgba() );
  QCOMPARE( palette->getRgba( 239 ), QColor(12, 5, 5, 255).rgba() );
  QCOMPARE( palette->getRgba( 240 ), QColor(243, 243, 243, 255).rgba() );
  QCOMPARE( palette->getRgba( 241 ), QColor(222, 222, 222, 255).rgba() );
  QCOMPARE( palette->getRgba( 242 ), QColor(204, 204, 204, 255).rgba() );
  QCOMPARE( palette->getRgba( 243 ), QColor(184, 184, 184, 255).rgba() );
  QCOMPARE( palette->getRgba( 244 ), QColor(163, 163, 163, 255).rgba() );
  QCOMPARE( palette->getRgba( 245 ), QColor(148, 148, 148, 255).rgba() );
  QCOMPARE( palette->getRgba( 246 ), QColor(133, 133, 133, 255).rgba() );
  QCOMPARE( palette->getRgba( 247 ), QColor(115, 115, 115, 255).rgba() );
  QCOMPARE( palette->getRgba( 248 ), QColor(102, 102, 102, 255).rgba() );
  QCOMPARE( palette->getRgba( 249 ), QColor(89, 89, 89, 255).rgba() );
  QCOMPARE( palette->getRgba( 250 ), QColor(76, 76, 76, 255).rgba() );
  QCOMPARE( palette->getRgba( 251 ), QColor(61, 61, 61, 255).rgba() );
  QCOMPARE( palette->getRgba( 252 ), QColor(46, 46, 46, 255).rgba() );
  QCOMPARE( palette->getRgba( 253 ), QColor(30, 30, 30, 255).rgba() );
  QCOMPARE( palette->getRgba( 254 ), QColor(17, 17, 17, 255).rgba() );
  QCOMPARE( palette->getRgba( 255 ), QColor(Qt::transparent).rgba() );

  // Advanced constructor
  QFile palette_file( "/levels/towndata/town.pal" );
  palette_file.open( QIODevice::ReadOnly );
  
  QByteArray palette_data( palette_file.size(), 0 );
  palette_file.read( palette_data.data(), palette_data.size() );
  
  palette.reset( new QtD1::CelPalette( "/levels/towndata/town.pal", palette_data ) );

  QCOMPARE( palette->getRgba( 0 ), QColor(0, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 1 ), QColor(181, 93, 27, 255).rgba() );
  QCOMPARE( palette->getRgba( 2 ), QColor(165, 93, 54, 255).rgba() );
  QCOMPARE( palette->getRgba( 3 ), QColor(165, 85, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 4 ), QColor(152, 86, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 5 ), QColor(143, 86, 59, 255).rgba() );
  QCOMPARE( palette->getRgba( 6 ), QColor(156, 84, 29, 255).rgba() );
  QCOMPARE( palette->getRgba( 7 ), QColor(141, 88, 27, 255).rgba() );
  QCOMPARE( palette->getRgba( 8 ), QColor(145, 82, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 9 ), QColor(139, 82, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 10 ), QColor(132, 73, 44, 255).rgba() );
  QCOMPARE( palette->getRgba( 11 ), QColor(161, 62, 18, 255).rgba() );
  QCOMPARE( palette->getRgba( 12 ), QColor(145, 66, 39, 255).rgba() );
  QCOMPARE( palette->getRgba( 13 ), QColor(82, 83, 117, 255).rgba() );
  QCOMPARE( palette->getRgba( 14 ), QColor(136, 70, 17, 255).rgba() );
  QCOMPARE( palette->getRgba( 15 ), QColor(120, 69, 51, 255).rgba() );
  QCOMPARE( palette->getRgba( 16 ), QColor(116, 74, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 17 ), QColor(120, 66, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 18 ), QColor(204, 24, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 19 ), QColor(107, 74, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 20 ), QColor(78, 74, 99, 255).rgba() );
  QCOMPARE( palette->getRgba( 21 ), QColor(120, 64, 26, 255).rgba() );
  QCOMPARE( palette->getRgba( 22 ), QColor(73, 71, 110, 255).rgba() );
  QCOMPARE( palette->getRgba( 23 ), QColor(206, 16, 32, 255).rgba() );
  QCOMPARE( palette->getRgba( 24 ), QColor(107, 66, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 25 ), QColor(198, 16, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 26 ), QColor(78, 66, 92, 255).rgba() );
  QCOMPARE( palette->getRgba( 27 ), QColor(198, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 28 ), QColor(99, 66, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 29 ), QColor(101, 61, 44, 255).rgba() );
  QCOMPARE( palette->getRgba( 30 ), QColor(83, 63, 75, 255).rgba() );
  QCOMPARE( palette->getRgba( 31 ), QColor(65, 67, 94, 255).rgba() );
  QCOMPARE( palette->getRgba( 32 ), QColor(189, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 33 ), QColor(101, 62, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 34 ), QColor(103, 56, 30, 255).rgba() );
  QCOMPARE( palette->getRgba( 35 ), QColor(181, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 36 ), QColor(181, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 37 ), QColor(173, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 38 ), QColor(173, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 39 ), QColor(165, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 40 ), QColor(62, 58, 78, 255).rgba() );
  QCOMPARE( palette->getRgba( 41 ), QColor(165, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 42 ), QColor(156, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 43 ), QColor(54, 54, 93, 255).rgba() );
  QCOMPARE( palette->getRgba( 44 ), QColor(156, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 45 ), QColor(78, 50, 28, 255).rgba() );
  QCOMPARE( palette->getRgba( 46 ), QColor(165, 8, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 47 ), QColor(67, 52, 46, 255).rgba() );
  QCOMPARE( palette->getRgba( 48 ), QColor(61, 48, 64, 255).rgba() );
  QCOMPARE( palette->getRgba( 49 ), QColor(81, 41, 45, 255).rgba() );
  QCOMPARE( palette->getRgba( 50 ), QColor(156, 8, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 51 ), QColor(145, 12, 17, 255).rgba() );
  QCOMPARE( palette->getRgba( 52 ), QColor(47, 50, 73, 255).rgba() );
  QCOMPARE( palette->getRgba( 53 ), QColor(73, 46, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 54 ), QColor(46, 49, 44, 255).rgba() );
  QCOMPARE( palette->getRgba( 55 ), QColor(129, 12, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 56 ), QColor(47, 49, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 57 ), QColor(57, 41, 45, 255).rgba() );
  QCOMPARE( palette->getRgba( 58 ), QColor(105, 19, 20, 255).rgba() );
  QCOMPARE( palette->getRgba( 59 ), QColor(43, 41, 71, 255).rgba() );
  QCOMPARE( palette->getRgba( 60 ), QColor(49, 41, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 61 ), QColor(45, 41, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 62 ), QColor(43, 40, 57, 255).rgba() );
  QCOMPARE( palette->getRgba( 63 ), QColor(52, 41, 20, 255).rgba() );
  QCOMPARE( palette->getRgba( 64 ), QColor(120, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 65 ), QColor(59, 32, 42, 255).rgba() );
  QCOMPARE( palette->getRgba( 66 ), QColor(44, 41, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 67 ), QColor(41, 41, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 68 ), QColor(68, 26, 26, 255).rgba() );
  QCOMPARE( palette->getRgba( 69 ), QColor(33, 41, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 70 ), QColor(49, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 71 ), QColor(33, 41, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 72 ), QColor(107, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 73 ), QColor(41, 33, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 74 ), QColor(33, 41, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 75 ), QColor(27, 35, 70, 255).rgba() );
  QCOMPARE( palette->getRgba( 76 ), QColor(41, 33, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 77 ), QColor(41, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 78 ), QColor(44, 33, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 79 ), QColor(99, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 80 ), QColor(46, 33, 12, 255).rgba() );
  QCOMPARE( palette->getRgba( 81 ), QColor(32, 33, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 82 ), QColor(33, 33, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 83 ), QColor(33, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 84 ), QColor(87, 10, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 85 ), QColor(33, 33, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 86 ), QColor(24, 33, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 87 ), QColor(33, 33, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 88 ), QColor(41, 24, 42, 255).rgba() );
  QCOMPARE( palette->getRgba( 89 ), QColor(44, 24, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 90 ), QColor(24, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 91 ), QColor(25, 28, 57, 255).rgba() );
  QCOMPARE( palette->getRgba( 92 ), QColor(33, 33, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 93 ), QColor(24, 33, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 94 ), QColor(24, 33, 14, 255).rgba() );
  QCOMPARE( palette->getRgba( 95 ), QColor(33, 24, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 96 ), QColor(43, 21, 18, 255).rgba() );
  QCOMPARE( palette->getRgba( 97 ), QColor(33, 24, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 98 ), QColor(33, 24, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 99 ), QColor(19, 24, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 100 ), QColor(24, 24, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 101 ), QColor(25, 22, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 102 ), QColor(24, 24, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 103 ), QColor(24, 24, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 104 ), QColor(16, 24, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 105 ), QColor(16, 24, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 106 ), QColor(24, 16, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 107 ), QColor(67, 0, 1, 255).rgba() );
  QCOMPARE( palette->getRgba( 108 ), QColor(28, 18, 6, 255).rgba() );
  QCOMPARE( palette->getRgba( 109 ), QColor(25, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 110 ), QColor(15, 18, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 111 ), QColor(25, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 112 ), QColor(16, 16, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 113 ), QColor(16, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 114 ), QColor(16, 16, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 115 ), QColor(8, 16, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 116 ), QColor(8, 16, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 117 ), QColor(16, 8, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 118 ), QColor(17, 8, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 119 ), QColor(8, 11, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 120 ), QColor(17, 8, 7, 255).rgba() );
  QCOMPARE( palette->getRgba( 121 ), QColor(8, 8, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 122 ), QColor(8, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 123 ), QColor(8, 8, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 124 ), QColor(0, 8, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 125 ), QColor(8, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 126 ), QColor(4, 0, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 127 ), QColor(0, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 128 ), QColor(159, 159, 255, 255).rgba() );
  QCOMPARE( palette->getRgba( 129 ), QColor(87, 87, 255, 255).rgba() );
  QCOMPARE( palette->getRgba( 130 ), QColor(36, 36, 254, 255).rgba() );
  QCOMPARE( palette->getRgba( 131 ), QColor(1, 1, 239, 255).rgba() );
  QCOMPARE( palette->getRgba( 132 ), QColor(0, 0, 189, 255).rgba() );
  QCOMPARE( palette->getRgba( 133 ), QColor(0, 0, 138, 255).rgba() );
  QCOMPARE( palette->getRgba( 134 ), QColor(0, 0, 87, 255).rgba() );
  QCOMPARE( palette->getRgba( 135 ), QColor(0, 0, 25, 255).rgba() );
  QCOMPARE( palette->getRgba( 136 ), QColor(255, 159, 159, 255).rgba() );
  QCOMPARE( palette->getRgba( 137 ), QColor(255, 87, 87, 255).rgba() );
  QCOMPARE( palette->getRgba( 138 ), QColor(254, 36, 36, 255).rgba() );
  QCOMPARE( palette->getRgba( 139 ), QColor(240, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 140 ), QColor(189, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 141 ), QColor(145, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 142 ), QColor(90, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 143 ), QColor(35, 0, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 144 ), QColor(255, 253, 159, 255).rgba() );
  QCOMPARE( palette->getRgba( 145 ), QColor(255, 252, 87, 255).rgba() );
  QCOMPARE( palette->getRgba( 146 ), QColor(254, 251, 36, 255).rgba() );
  QCOMPARE( palette->getRgba( 147 ), QColor(240, 236, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 148 ), QColor(195, 195, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 149 ), QColor(134, 134, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 150 ), QColor(87, 85, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 151 ), QColor(25, 25, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 152 ), QColor(254, 190, 160, 255).rgba() );
  QCOMPARE( palette->getRgba( 153 ), QColor(255, 140, 87, 255).rgba() );
  QCOMPARE( palette->getRgba( 154 ), QColor(254, 105, 36, 255).rgba() );
  QCOMPARE( palette->getRgba( 155 ), QColor(240, 76, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 156 ), QColor(199, 65, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 157 ), QColor(143, 46, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 158 ), QColor(87, 26, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 159 ), QColor(30, 7, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 160 ), QColor(232, 202, 202, 255).rgba() );
  QCOMPARE( palette->getRgba( 161 ), QColor(215, 178, 178, 255).rgba() );
  QCOMPARE( palette->getRgba( 162 ), QColor(202, 158, 158, 255).rgba() );
  QCOMPARE( palette->getRgba( 163 ), QColor(189, 143, 143, 255).rgba() );
  QCOMPARE( palette->getRgba( 164 ), QColor(179, 128, 128, 255).rgba() );
  QCOMPARE( palette->getRgba( 165 ), QColor(168, 113, 113, 255).rgba() );
  QCOMPARE( palette->getRgba( 166 ), QColor(165, 90, 90, 255).rgba() );
  QCOMPARE( palette->getRgba( 167 ), QColor(156, 73, 73, 255).rgba() );
  QCOMPARE( palette->getRgba( 168 ), QColor(139, 65, 65, 255).rgba() );
  QCOMPARE( palette->getRgba( 169 ), QColor(121, 57, 57, 255).rgba() );
  QCOMPARE( palette->getRgba( 170 ), QColor(104, 49, 49, 255).rgba() );
  QCOMPARE( palette->getRgba( 171 ), QColor(86, 41, 41, 255).rgba() );
  QCOMPARE( palette->getRgba( 172 ), QColor(68, 33, 33, 255).rgba() );
  QCOMPARE( palette->getRgba( 173 ), QColor(51, 25, 25, 255).rgba() );
  QCOMPARE( palette->getRgba( 174 ), QColor(27, 14, 14, 255).rgba() );
  QCOMPARE( palette->getRgba( 175 ), QColor(12, 7, 7, 255).rgba() );
  QCOMPARE( palette->getRgba( 176 ), QColor(200, 205, 234, 255).rgba() );
  QCOMPARE( palette->getRgba( 177 ), QColor(178, 183, 215, 255).rgba() );
  QCOMPARE( palette->getRgba( 178 ), QColor(159, 165, 198, 255).rgba() );
  QCOMPARE( palette->getRgba( 179 ), QColor(147, 153, 185, 255).rgba() );
  QCOMPARE( palette->getRgba( 180 ), QColor(135, 141, 172, 255).rgba() );
  QCOMPARE( palette->getRgba( 181 ), QColor(121, 127, 160, 255).rgba() );
  QCOMPARE( palette->getRgba( 182 ), QColor(102, 112, 153, 255).rgba() );
  QCOMPARE( palette->getRgba( 183 ), QColor(88, 99, 141, 255).rgba() );
  QCOMPARE( palette->getRgba( 184 ), QColor(78, 88, 125, 255).rgba() );
  QCOMPARE( palette->getRgba( 185 ), QColor(67, 76, 111, 255).rgba() );
  QCOMPARE( palette->getRgba( 186 ), QColor(57, 65, 95, 255).rgba() );
  QCOMPARE( palette->getRgba( 187 ), QColor(47, 54, 80, 255).rgba() );
  QCOMPARE( palette->getRgba( 188 ), QColor(37, 43, 65, 255).rgba() );
  QCOMPARE( palette->getRgba( 189 ), QColor(25, 30, 45, 255).rgba() );
  QCOMPARE( palette->getRgba( 190 ), QColor(13, 17, 27, 255).rgba() );
  QCOMPARE( palette->getRgba( 191 ), QColor(5, 7, 12, 255).rgba() );
  QCOMPARE( palette->getRgba( 192 ), QColor(255, 227, 164, 255).rgba() );
  QCOMPARE( palette->getRgba( 193 ), QColor(238, 209, 140, 255).rgba() );
  QCOMPARE( palette->getRgba( 194 ), QColor(221, 196, 126, 255).rgba() );
  QCOMPARE( palette->getRgba( 195 ), QColor(204, 183, 117, 255).rgba() );
  QCOMPARE( palette->getRgba( 196 ), QColor(188, 168, 108, 255).rgba() );
  QCOMPARE( palette->getRgba( 197 ), QColor(171, 154, 99, 255).rgba() );
  QCOMPARE( palette->getRgba( 198 ), QColor(152, 139, 93, 255).rgba() );
  QCOMPARE( palette->getRgba( 199 ), QColor(135, 126, 84, 255).rgba() );
  QCOMPARE( palette->getRgba( 200 ), QColor(120, 111, 73, 255).rgba() );
  QCOMPARE( palette->getRgba( 201 ), QColor(105, 96, 63, 255).rgba() );
  QCOMPARE( palette->getRgba( 202 ), QColor(91, 81, 52, 255).rgba() );
  QCOMPARE( palette->getRgba( 203 ), QColor(72, 64, 39, 255).rgba() );
  QCOMPARE( palette->getRgba( 204 ), QColor(57, 49, 29, 255).rgba() );
  QCOMPARE( palette->getRgba( 205 ), QColor(49, 40, 22, 255).rgba() );
  QCOMPARE( palette->getRgba( 206 ), QColor(26, 20, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 207 ), QColor(20, 11, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 208 ), QColor(255, 226, 179, 255).rgba() );
  QCOMPARE( palette->getRgba( 209 ), QColor(244, 201, 150, 255).rgba() );
  QCOMPARE( palette->getRgba( 210 ), QColor(231, 179, 126, 255).rgba() );
  QCOMPARE( palette->getRgba( 211 ), QColor(220, 159, 112, 255).rgba() );
  QCOMPARE( palette->getRgba( 212 ), QColor(208, 140, 98, 255).rgba() );
  QCOMPARE( palette->getRgba( 213 ), QColor(199, 123, 82, 255).rgba() );
  QCOMPARE( palette->getRgba( 214 ), QColor(204, 97, 51, 255).rgba() );
  QCOMPARE( palette->getRgba( 215 ), QColor(199, 75, 31, 255).rgba() );
  QCOMPARE( palette->getRgba( 216 ), QColor(177, 67, 27, 255).rgba() );
  QCOMPARE( palette->getRgba( 217 ), QColor(155, 59, 24, 255).rgba() );
  QCOMPARE( palette->getRgba( 218 ), QColor(133, 50, 19, 255).rgba() );
  QCOMPARE( palette->getRgba( 219 ), QColor(111, 41, 16, 255).rgba() );
  QCOMPARE( palette->getRgba( 220 ), QColor(90, 34, 12, 255).rgba() );
  QCOMPARE( palette->getRgba( 221 ), QColor(63, 23, 8, 255).rgba() );
  QCOMPARE( palette->getRgba( 222 ), QColor(37, 14, 3, 255).rgba() );
  QCOMPARE( palette->getRgba( 223 ), QColor(15, 5, 0, 255).rgba() );
  QCOMPARE( palette->getRgba( 224 ), QColor(255, 189, 189, 255).rgba() );
  QCOMPARE( palette->getRgba( 225 ), QColor(244, 150, 150, 255).rgba() );
  QCOMPARE( palette->getRgba( 226 ), QColor(232, 125, 125, 255).rgba() );
  QCOMPARE( palette->getRgba( 227 ), QColor(224, 108, 108, 255).rgba() );
  QCOMPARE( palette->getRgba( 228 ), QColor(216, 91, 91, 255).rgba() );
  QCOMPARE( palette->getRgba( 229 ), QColor(207, 73, 73, 255).rgba() );
  QCOMPARE( palette->getRgba( 230 ), QColor(199, 56, 56, 255).rgba() );
  QCOMPARE( palette->getRgba( 231 ), QColor(191, 39, 39, 255).rgba() );
  QCOMPARE( palette->getRgba( 232 ), QColor(169, 34, 34, 255).rgba() );
  QCOMPARE( palette->getRgba( 233 ), QColor(147, 30, 30, 255).rgba() );
  QCOMPARE( palette->getRgba( 234 ), QColor(124, 25, 25, 255).rgba() );
  QCOMPARE( palette->getRgba( 235 ), QColor(102, 21, 21, 255).rgba() );
  QCOMPARE( palette->getRgba( 236 ), QColor(79, 17, 17, 255).rgba() );
  QCOMPARE( palette->getRgba( 237 ), QColor(57, 13, 13, 255).rgba() );
  QCOMPARE( palette->getRgba( 238 ), QColor(35, 9, 9, 255).rgba() );
  QCOMPARE( palette->getRgba( 239 ), QColor(12, 5, 5, 255).rgba() );
  QCOMPARE( palette->getRgba( 240 ), QColor(243, 243, 243, 255).rgba() );
  QCOMPARE( palette->getRgba( 241 ), QColor(222, 222, 222, 255).rgba() );
  QCOMPARE( palette->getRgba( 242 ), QColor(204, 204, 204, 255).rgba() );
  QCOMPARE( palette->getRgba( 243 ), QColor(184, 184, 184, 255).rgba() );
  QCOMPARE( palette->getRgba( 244 ), QColor(163, 163, 163, 255).rgba() );
  QCOMPARE( palette->getRgba( 245 ), QColor(148, 148, 148, 255).rgba() );
  QCOMPARE( palette->getRgba( 246 ), QColor(133, 133, 133, 255).rgba() );
  QCOMPARE( palette->getRgba( 247 ), QColor(115, 115, 115, 255).rgba() );
  QCOMPARE( palette->getRgba( 248 ), QColor(102, 102, 102, 255).rgba() );
  QCOMPARE( palette->getRgba( 249 ), QColor(89, 89, 89, 255).rgba() );
  QCOMPARE( palette->getRgba( 250 ), QColor(76, 76, 76, 255).rgba() );
  QCOMPARE( palette->getRgba( 251 ), QColor(61, 61, 61, 255).rgba() );
  QCOMPARE( palette->getRgba( 252 ), QColor(46, 46, 46, 255).rgba() );
  QCOMPARE( palette->getRgba( 253 ), QColor(30, 30, 30, 255).rgba() );
  QCOMPARE( palette->getRgba( 254 ), QColor(17, 17, 17, 255).rgba() );
  QCOMPARE( palette->getRgba( 255 ), QColor(Qt::transparent).rgba() );
}

//---------------------------------------------------------------------------//
// Check that the palette can be converted to a QImage color table 
void toColorTable()
{
  std::unique_ptr<QtD1::CelPalette>
    palette( new QtD1::CelPalette("/levels/towndata/town.pal") );

  QVector<QRgb> color_table = palette->toColorTable();

  QCOMPARE( color_table[0], QColor(0, 0, 0, 255).rgba() );
  QCOMPARE( color_table[1], QColor(181, 93, 27, 255).rgba() );
  QCOMPARE( color_table[2], QColor(165, 93, 54, 255).rgba() );
  QCOMPARE( color_table[3], QColor(165, 85, 24, 255).rgba() );
  QCOMPARE( color_table[4], QColor(152, 86, 49, 255).rgba() );
  QCOMPARE( color_table[5], QColor(143, 86, 59, 255).rgba() );
  QCOMPARE( color_table[6], QColor(156, 84, 29, 255).rgba() );
  QCOMPARE( color_table[7], QColor(141, 88, 27, 255).rgba() );
  QCOMPARE( color_table[8], QColor(145, 82, 41, 255).rgba() );
  QCOMPARE( color_table[9], QColor(139, 82, 49, 255).rgba() );
  QCOMPARE( color_table[10], QColor(132, 73, 44, 255).rgba() );
  QCOMPARE( color_table[11], QColor(161, 62, 18, 255).rgba() );
  QCOMPARE( color_table[12], QColor(145, 66, 39, 255).rgba() );
  QCOMPARE( color_table[13], QColor(82, 83, 117, 255).rgba() );
  QCOMPARE( color_table[14], QColor(136, 70, 17, 255).rgba() );
  QCOMPARE( color_table[15], QColor(120, 69, 51, 255).rgba() );
  QCOMPARE( color_table[16], QColor(116, 74, 24, 255).rgba() );
  QCOMPARE( color_table[17], QColor(120, 66, 41, 255).rgba() );
  QCOMPARE( color_table[18], QColor(204, 24, 33, 255).rgba() );
  QCOMPARE( color_table[19], QColor(107, 74, 24, 255).rgba() );
  QCOMPARE( color_table[20], QColor(78, 74, 99, 255).rgba() );
  QCOMPARE( color_table[21], QColor(120, 64, 26, 255).rgba() );
  QCOMPARE( color_table[22], QColor(73, 71, 110, 255).rgba() );
  QCOMPARE( color_table[23], QColor(206, 16, 32, 255).rgba() );
  QCOMPARE( color_table[24], QColor(107, 66, 24, 255).rgba() );
  QCOMPARE( color_table[25], QColor(198, 16, 33, 255).rgba() );
  QCOMPARE( color_table[26], QColor(78, 66, 92, 255).rgba() );
  QCOMPARE( color_table[27], QColor(198, 16, 24, 255).rgba() );
  QCOMPARE( color_table[28], QColor(99, 66, 24, 255).rgba() );
  QCOMPARE( color_table[29], QColor(101, 61, 44, 255).rgba() );
  QCOMPARE( color_table[30], QColor(83, 63, 75, 255).rgba() );
  QCOMPARE( color_table[31], QColor(65, 67, 94, 255).rgba() );
  QCOMPARE( color_table[32], QColor(189, 16, 24, 255).rgba() );
  QCOMPARE( color_table[33], QColor(101, 62, 16, 255).rgba() );
  QCOMPARE( color_table[34], QColor(103, 56, 30, 255).rgba() );
  QCOMPARE( color_table[35], QColor(181, 16, 24, 255).rgba() );
  QCOMPARE( color_table[36], QColor(181, 16, 16, 255).rgba() );
  QCOMPARE( color_table[37], QColor(173, 16, 24, 255).rgba() );
  QCOMPARE( color_table[38], QColor(173, 16, 16, 255).rgba() );
  QCOMPARE( color_table[39], QColor(165, 16, 24, 255).rgba() );
  QCOMPARE( color_table[40], QColor(62, 58, 78, 255).rgba() );
  QCOMPARE( color_table[41], QColor(165, 16, 16, 255).rgba() );
  QCOMPARE( color_table[42], QColor(156, 16, 24, 255).rgba() );
  QCOMPARE( color_table[43], QColor(54, 54, 93, 255).rgba() );
  QCOMPARE( color_table[44], QColor(156, 16, 16, 255).rgba() );
  QCOMPARE( color_table[45], QColor(78, 50, 28, 255).rgba() );
  QCOMPARE( color_table[46], QColor(165, 8, 16, 255).rgba() );
  QCOMPARE( color_table[47], QColor(67, 52, 46, 255).rgba() );
  QCOMPARE( color_table[48], QColor(61, 48, 64, 255).rgba() );
  QCOMPARE( color_table[49], QColor(81, 41, 45, 255).rgba() );
  QCOMPARE( color_table[50], QColor(156, 8, 16, 255).rgba() );
  QCOMPARE( color_table[51], QColor(145, 12, 17, 255).rgba() );
  QCOMPARE( color_table[52], QColor(47, 50, 73, 255).rgba() );
  QCOMPARE( color_table[53], QColor(73, 46, 16, 255).rgba() );
  QCOMPARE( color_table[54], QColor(46, 49, 44, 255).rgba() );
  QCOMPARE( color_table[55], QColor(129, 12, 16, 255).rgba() );
  QCOMPARE( color_table[56], QColor(47, 49, 33, 255).rgba() );
  QCOMPARE( color_table[57], QColor(57, 41, 45, 255).rgba() );
  QCOMPARE( color_table[58], QColor(105, 19, 20, 255).rgba() );
  QCOMPARE( color_table[59], QColor(43, 41, 71, 255).rgba() );
  QCOMPARE( color_table[60], QColor(49, 41, 41, 255).rgba() );
  QCOMPARE( color_table[61], QColor(45, 41, 49, 255).rgba() );
  QCOMPARE( color_table[62], QColor(43, 40, 57, 255).rgba() );
  QCOMPARE( color_table[63], QColor(52, 41, 20, 255).rgba() );
  QCOMPARE( color_table[64], QColor(120, 8, 8, 255).rgba() );
  QCOMPARE( color_table[65], QColor(59, 32, 42, 255).rgba() );
  QCOMPARE( color_table[66], QColor(44, 41, 33, 255).rgba() );
  QCOMPARE( color_table[67], QColor(41, 41, 41, 255).rgba() );
  QCOMPARE( color_table[68], QColor(68, 26, 26, 255).rgba() );
  QCOMPARE( color_table[69], QColor(33, 41, 41, 255).rgba() );
  QCOMPARE( color_table[70], QColor(49, 33, 33, 255).rgba() );
  QCOMPARE( color_table[71], QColor(33, 41, 33, 255).rgba() );
  QCOMPARE( color_table[72], QColor(107, 8, 8, 255).rgba() );
  QCOMPARE( color_table[73], QColor(41, 33, 49, 255).rgba() );
  QCOMPARE( color_table[74], QColor(33, 41, 24, 255).rgba() );
  QCOMPARE( color_table[75], QColor(27, 35, 70, 255).rgba() );
  QCOMPARE( color_table[76], QColor(41, 33, 41, 255).rgba() );
  QCOMPARE( color_table[77], QColor(41, 33, 33, 255).rgba() );
  QCOMPARE( color_table[78], QColor(44, 33, 24, 255).rgba() );
  QCOMPARE( color_table[79], QColor(99, 8, 8, 255).rgba() );
  QCOMPARE( color_table[80], QColor(46, 33, 12, 255).rgba() );
  QCOMPARE( color_table[81], QColor(32, 33, 49, 255).rgba() );
  QCOMPARE( color_table[82], QColor(33, 33, 41, 255).rgba() );
  QCOMPARE( color_table[83], QColor(33, 33, 33, 255).rgba() );
  QCOMPARE( color_table[84], QColor(87, 10, 8, 255).rgba() );
  QCOMPARE( color_table[85], QColor(33, 33, 24, 255).rgba() );
  QCOMPARE( color_table[86], QColor(24, 33, 41, 255).rgba() );
  QCOMPARE( color_table[87], QColor(33, 33, 16, 255).rgba() );
  QCOMPARE( color_table[88], QColor(41, 24, 42, 255).rgba() );
  QCOMPARE( color_table[89], QColor(44, 24, 33, 255).rgba() );
  QCOMPARE( color_table[90], QColor(24, 33, 33, 255).rgba() );
  QCOMPARE( color_table[91], QColor(25, 28, 57, 255).rgba() );
  QCOMPARE( color_table[92], QColor(33, 33, 8, 255).rgba() );
  QCOMPARE( color_table[93], QColor(24, 33, 24, 255).rgba() );
  QCOMPARE( color_table[94], QColor(24, 33, 14, 255).rgba() );
  QCOMPARE( color_table[95], QColor(33, 24, 33, 255).rgba() );
  QCOMPARE( color_table[96], QColor(43, 21, 18, 255).rgba() );
  QCOMPARE( color_table[97], QColor(33, 24, 24, 255).rgba() );
  QCOMPARE( color_table[98], QColor(33, 24, 16, 255).rgba() );
  QCOMPARE( color_table[99], QColor(19, 24, 49, 255).rgba() );
  QCOMPARE( color_table[100], QColor(24, 24, 33, 255).rgba() );
  QCOMPARE( color_table[101], QColor(25, 22, 41, 255).rgba() );
  QCOMPARE( color_table[102], QColor(24, 24, 24, 255).rgba() );
  QCOMPARE( color_table[103], QColor(24, 24, 16, 255).rgba() );
  QCOMPARE( color_table[104], QColor(16, 24, 24, 255).rgba() );
  QCOMPARE( color_table[105], QColor(16, 24, 16, 255).rgba() );
  QCOMPARE( color_table[106], QColor(24, 16, 33, 255).rgba() );
  QCOMPARE( color_table[107], QColor(67, 0, 1, 255).rgba() );
  QCOMPARE( color_table[108], QColor(28, 18, 6, 255).rgba() );
  QCOMPARE( color_table[109], QColor(25, 16, 24, 255).rgba() );
  QCOMPARE( color_table[110], QColor(15, 18, 33, 255).rgba() );
  QCOMPARE( color_table[111], QColor(25, 16, 16, 255).rgba() );
  QCOMPARE( color_table[112], QColor(16, 16, 24, 255).rgba() );
  QCOMPARE( color_table[113], QColor(16, 16, 16, 255).rgba() );
  QCOMPARE( color_table[114], QColor(16, 16, 8, 255).rgba() );
  QCOMPARE( color_table[115], QColor(8, 16, 16, 255).rgba() );
  QCOMPARE( color_table[116], QColor(8, 16, 8, 255).rgba() );
  QCOMPARE( color_table[117], QColor(16, 8, 24, 255).rgba() );
  QCOMPARE( color_table[118], QColor(17, 8, 16, 255).rgba() );
  QCOMPARE( color_table[119], QColor(8, 11, 24, 255).rgba() );
  QCOMPARE( color_table[120], QColor(17, 8, 7, 255).rgba() );
  QCOMPARE( color_table[121], QColor(8, 8, 16, 255).rgba() );
  QCOMPARE( color_table[122], QColor(8, 8, 8, 255).rgba() );
  QCOMPARE( color_table[123], QColor(8, 8, 0, 255).rgba() );
  QCOMPARE( color_table[124], QColor(0, 8, 8, 255).rgba() );
  QCOMPARE( color_table[125], QColor(8, 0, 0, 255).rgba() );
  QCOMPARE( color_table[126], QColor(4, 0, 8, 255).rgba() );
  QCOMPARE( color_table[127], QColor(0, 0, 0, 255).rgba() );
  QCOMPARE( color_table[128], QColor(159, 159, 255, 255).rgba() );
  QCOMPARE( color_table[129], QColor(87, 87, 255, 255).rgba() );
  QCOMPARE( color_table[130], QColor(36, 36, 254, 255).rgba() );
  QCOMPARE( color_table[131], QColor(1, 1, 239, 255).rgba() );
  QCOMPARE( color_table[132], QColor(0, 0, 189, 255).rgba() );
  QCOMPARE( color_table[133], QColor(0, 0, 138, 255).rgba() );
  QCOMPARE( color_table[134], QColor(0, 0, 87, 255).rgba() );
  QCOMPARE( color_table[135], QColor(0, 0, 25, 255).rgba() );
  QCOMPARE( color_table[136], QColor(255, 159, 159, 255).rgba() );
  QCOMPARE( color_table[137], QColor(255, 87, 87, 255).rgba() );
  QCOMPARE( color_table[138], QColor(254, 36, 36, 255).rgba() );
  QCOMPARE( color_table[139], QColor(240, 0, 0, 255).rgba() );
  QCOMPARE( color_table[140], QColor(189, 0, 0, 255).rgba() );
  QCOMPARE( color_table[141], QColor(145, 0, 0, 255).rgba() );
  QCOMPARE( color_table[142], QColor(90, 0, 0, 255).rgba() );
  QCOMPARE( color_table[143], QColor(35, 0, 0, 255).rgba() );
  QCOMPARE( color_table[144], QColor(255, 253, 159, 255).rgba() );
  QCOMPARE( color_table[145], QColor(255, 252, 87, 255).rgba() );
  QCOMPARE( color_table[146], QColor(254, 251, 36, 255).rgba() );
  QCOMPARE( color_table[147], QColor(240, 236, 0, 255).rgba() );
  QCOMPARE( color_table[148], QColor(195, 195, 0, 255).rgba() );
  QCOMPARE( color_table[149], QColor(134, 134, 0, 255).rgba() );
  QCOMPARE( color_table[150], QColor(87, 85, 0, 255).rgba() );
  QCOMPARE( color_table[151], QColor(25, 25, 0, 255).rgba() );
  QCOMPARE( color_table[152], QColor(254, 190, 160, 255).rgba() );
  QCOMPARE( color_table[153], QColor(255, 140, 87, 255).rgba() );
  QCOMPARE( color_table[154], QColor(254, 105, 36, 255).rgba() );
  QCOMPARE( color_table[155], QColor(240, 76, 0, 255).rgba() );
  QCOMPARE( color_table[156], QColor(199, 65, 0, 255).rgba() );
  QCOMPARE( color_table[157], QColor(143, 46, 0, 255).rgba() );
  QCOMPARE( color_table[158], QColor(87, 26, 0, 255).rgba() );
  QCOMPARE( color_table[159], QColor(30, 7, 0, 255).rgba() );
  QCOMPARE( color_table[160], QColor(232, 202, 202, 255).rgba() );
  QCOMPARE( color_table[161], QColor(215, 178, 178, 255).rgba() );
  QCOMPARE( color_table[162], QColor(202, 158, 158, 255).rgba() );
  QCOMPARE( color_table[163], QColor(189, 143, 143, 255).rgba() );
  QCOMPARE( color_table[164], QColor(179, 128, 128, 255).rgba() );
  QCOMPARE( color_table[165], QColor(168, 113, 113, 255).rgba() );
  QCOMPARE( color_table[166], QColor(165, 90, 90, 255).rgba() );
  QCOMPARE( color_table[167], QColor(156, 73, 73, 255).rgba() );
  QCOMPARE( color_table[168], QColor(139, 65, 65, 255).rgba() );
  QCOMPARE( color_table[169], QColor(121, 57, 57, 255).rgba() );
  QCOMPARE( color_table[170], QColor(104, 49, 49, 255).rgba() );
  QCOMPARE( color_table[171], QColor(86, 41, 41, 255).rgba() );
  QCOMPARE( color_table[172], QColor(68, 33, 33, 255).rgba() );
  QCOMPARE( color_table[173], QColor(51, 25, 25, 255).rgba() );
  QCOMPARE( color_table[174], QColor(27, 14, 14, 255).rgba() );
  QCOMPARE( color_table[175], QColor(12, 7, 7, 255).rgba() );
  QCOMPARE( color_table[176], QColor(200, 205, 234, 255).rgba() );
  QCOMPARE( color_table[177], QColor(178, 183, 215, 255).rgba() );
  QCOMPARE( color_table[178], QColor(159, 165, 198, 255).rgba() );
  QCOMPARE( color_table[179], QColor(147, 153, 185, 255).rgba() );
  QCOMPARE( color_table[180], QColor(135, 141, 172, 255).rgba() );
  QCOMPARE( color_table[181], QColor(121, 127, 160, 255).rgba() );
  QCOMPARE( color_table[182], QColor(102, 112, 153, 255).rgba() );
  QCOMPARE( color_table[183], QColor(88, 99, 141, 255).rgba() );
  QCOMPARE( color_table[184], QColor(78, 88, 125, 255).rgba() );
  QCOMPARE( color_table[185], QColor(67, 76, 111, 255).rgba() );
  QCOMPARE( color_table[186], QColor(57, 65, 95, 255).rgba() );
  QCOMPARE( color_table[187], QColor(47, 54, 80, 255).rgba() );
  QCOMPARE( color_table[188], QColor(37, 43, 65, 255).rgba() );
  QCOMPARE( color_table[189], QColor(25, 30, 45, 255).rgba() );
  QCOMPARE( color_table[190], QColor(13, 17, 27, 255).rgba() );
  QCOMPARE( color_table[191], QColor(5, 7, 12, 255).rgba() );
  QCOMPARE( color_table[192], QColor(255, 227, 164, 255).rgba() );
  QCOMPARE( color_table[193], QColor(238, 209, 140, 255).rgba() );
  QCOMPARE( color_table[194], QColor(221, 196, 126, 255).rgba() );
  QCOMPARE( color_table[195], QColor(204, 183, 117, 255).rgba() );
  QCOMPARE( color_table[196], QColor(188, 168, 108, 255).rgba() );
  QCOMPARE( color_table[197], QColor(171, 154, 99, 255).rgba() );
  QCOMPARE( color_table[198], QColor(152, 139, 93, 255).rgba() );
  QCOMPARE( color_table[199], QColor(135, 126, 84, 255).rgba() );
  QCOMPARE( color_table[200], QColor(120, 111, 73, 255).rgba() );
  QCOMPARE( color_table[201], QColor(105, 96, 63, 255).rgba() );
  QCOMPARE( color_table[202], QColor(91, 81, 52, 255).rgba() );
  QCOMPARE( color_table[203], QColor(72, 64, 39, 255).rgba() );
  QCOMPARE( color_table[204], QColor(57, 49, 29, 255).rgba() );
  QCOMPARE( color_table[205], QColor(49, 40, 22, 255).rgba() );
  QCOMPARE( color_table[206], QColor(26, 20, 8, 255).rgba() );
  QCOMPARE( color_table[207], QColor(20, 11, 0, 255).rgba() );
  QCOMPARE( color_table[208], QColor(255, 226, 179, 255).rgba() );
  QCOMPARE( color_table[209], QColor(244, 201, 150, 255).rgba() );
  QCOMPARE( color_table[210], QColor(231, 179, 126, 255).rgba() );
  QCOMPARE( color_table[211], QColor(220, 159, 112, 255).rgba() );
  QCOMPARE( color_table[212], QColor(208, 140, 98, 255).rgba() );
  QCOMPARE( color_table[213], QColor(199, 123, 82, 255).rgba() );
  QCOMPARE( color_table[214], QColor(204, 97, 51, 255).rgba() );
  QCOMPARE( color_table[215], QColor(199, 75, 31, 255).rgba() );
  QCOMPARE( color_table[216], QColor(177, 67, 27, 255).rgba() );
  QCOMPARE( color_table[217], QColor(155, 59, 24, 255).rgba() );
  QCOMPARE( color_table[218], QColor(133, 50, 19, 255).rgba() );
  QCOMPARE( color_table[219], QColor(111, 41, 16, 255).rgba() );
  QCOMPARE( color_table[220], QColor(90, 34, 12, 255).rgba() );
  QCOMPARE( color_table[221], QColor(63, 23, 8, 255).rgba() );
  QCOMPARE( color_table[222], QColor(37, 14, 3, 255).rgba() );
  QCOMPARE( color_table[223], QColor(15, 5, 0, 255).rgba() );
  QCOMPARE( color_table[224], QColor(255, 189, 189, 255).rgba() );
  QCOMPARE( color_table[225], QColor(244, 150, 150, 255).rgba() );
  QCOMPARE( color_table[226], QColor(232, 125, 125, 255).rgba() );
  QCOMPARE( color_table[227], QColor(224, 108, 108, 255).rgba() );
  QCOMPARE( color_table[228], QColor(216, 91, 91, 255).rgba() );
  QCOMPARE( color_table[229], QColor(207, 73, 73, 255).rgba() );
  QCOMPARE( color_table[230], QColor(199, 56, 56, 255).rgba() );
  QCOMPARE( color_table[231], QColor(191, 39, 39, 255).rgba() );
  QCOMPARE( color_table[232], QColor(169, 34, 34, 255).rgba() );
  QCOMPARE( color_table[233], QColor(147, 30, 30, 255).rgba() );
  QCOMPARE( color_table[234], QColor(124, 25, 25, 255).rgba() );
  QCOMPARE( color_table[235], QColor(102, 21, 21, 255).rgba() );
  QCOMPARE( color_table[236], QColor(79, 17, 17, 255).rgba() );
  QCOMPARE( color_table[237], QColor(57, 13, 13, 255).rgba() );
  QCOMPARE( color_table[238], QColor(35, 9, 9, 255).rgba() );
  QCOMPARE( color_table[239], QColor(12, 5, 5, 255).rgba() );
  QCOMPARE( color_table[240], QColor(243, 243, 243, 255).rgba() );
  QCOMPARE( color_table[241], QColor(222, 222, 222, 255).rgba() );
  QCOMPARE( color_table[242], QColor(204, 204, 204, 255).rgba() );
  QCOMPARE( color_table[243], QColor(184, 184, 184, 255).rgba() );
  QCOMPARE( color_table[244], QColor(163, 163, 163, 255).rgba() );
  QCOMPARE( color_table[245], QColor(148, 148, 148, 255).rgba() );
  QCOMPARE( color_table[246], QColor(133, 133, 133, 255).rgba() );
  QCOMPARE( color_table[247], QColor(115, 115, 115, 255).rgba() );
  QCOMPARE( color_table[248], QColor(102, 102, 102, 255).rgba() );
  QCOMPARE( color_table[249], QColor(89, 89, 89, 255).rgba() );
  QCOMPARE( color_table[250], QColor(76, 76, 76, 255).rgba() );
  QCOMPARE( color_table[251], QColor(61, 61, 61, 255).rgba() );
  QCOMPARE( color_table[252], QColor(46, 46, 46, 255).rgba() );
  QCOMPARE( color_table[253], QColor(30, 30, 30, 255).rgba() );
  QCOMPARE( color_table[254], QColor(17, 17, 17, 255).rgba() );
  QCOMPARE( color_table[255], QColor(Qt::transparent).rgba() );
}

//---------------------------------------------------------------------------//
// End test suite.
//---------------------------------------------------------------------------//
};

//---------------------------------------------------------------------------//
// Test Main
//---------------------------------------------------------------------------//
QTEST_MAIN( TestCelPalette )
#include "tstCelPalette.moc"

//---------------------------------------------------------------------------//
// end tstCelPalette.cpp
//---------------------------------------------------------------------------//
